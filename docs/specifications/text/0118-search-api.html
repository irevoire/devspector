<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Search API | Welcome to the Meilisearch dev specifications!</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.b26ff90a.css" as="style"><link rel="preload" href="/assets/js/app.a3343b22.js" as="script"><link rel="preload" href="/assets/js/3.7860be15.js" as="script"><link rel="preload" href="/assets/js/35.543c03a1.js" as="script"><link rel="prefetch" href="/assets/js/10.867f19e5.js"><link rel="prefetch" href="/assets/js/11.729a6b35.js"><link rel="prefetch" href="/assets/js/12.3fc27b6c.js"><link rel="prefetch" href="/assets/js/13.569b541d.js"><link rel="prefetch" href="/assets/js/14.5eb4b1a7.js"><link rel="prefetch" href="/assets/js/15.ffba3d85.js"><link rel="prefetch" href="/assets/js/16.5bbcf611.js"><link rel="prefetch" href="/assets/js/17.052e3dd6.js"><link rel="prefetch" href="/assets/js/18.1930f072.js"><link rel="prefetch" href="/assets/js/19.1ce2f361.js"><link rel="prefetch" href="/assets/js/20.bbf42276.js"><link rel="prefetch" href="/assets/js/21.2d9b101a.js"><link rel="prefetch" href="/assets/js/22.1f07eccb.js"><link rel="prefetch" href="/assets/js/23.49f62338.js"><link rel="prefetch" href="/assets/js/24.bdd429da.js"><link rel="prefetch" href="/assets/js/25.d65be380.js"><link rel="prefetch" href="/assets/js/26.d95b24bd.js"><link rel="prefetch" href="/assets/js/27.657689b8.js"><link rel="prefetch" href="/assets/js/28.6d50322d.js"><link rel="prefetch" href="/assets/js/29.28370923.js"><link rel="prefetch" href="/assets/js/30.9828f922.js"><link rel="prefetch" href="/assets/js/31.58809cac.js"><link rel="prefetch" href="/assets/js/32.733e95db.js"><link rel="prefetch" href="/assets/js/33.fbc8f9dc.js"><link rel="prefetch" href="/assets/js/34.bda1b03c.js"><link rel="prefetch" href="/assets/js/36.e60a6e3a.js"><link rel="prefetch" href="/assets/js/37.2e37d485.js"><link rel="prefetch" href="/assets/js/38.d9bfbb6f.js"><link rel="prefetch" href="/assets/js/39.c6446eba.js"><link rel="prefetch" href="/assets/js/4.3d6ce9d6.js"><link rel="prefetch" href="/assets/js/40.ac463bc0.js"><link rel="prefetch" href="/assets/js/41.9efc1325.js"><link rel="prefetch" href="/assets/js/42.578ced59.js"><link rel="prefetch" href="/assets/js/43.d2b6d075.js"><link rel="prefetch" href="/assets/js/44.a2214c33.js"><link rel="prefetch" href="/assets/js/45.2c7442dc.js"><link rel="prefetch" href="/assets/js/46.c82eebd0.js"><link rel="prefetch" href="/assets/js/47.42c0150d.js"><link rel="prefetch" href="/assets/js/48.02b2c80a.js"><link rel="prefetch" href="/assets/js/49.c3c4d010.js"><link rel="prefetch" href="/assets/js/5.06848b4d.js"><link rel="prefetch" href="/assets/js/50.20f74a2a.js"><link rel="prefetch" href="/assets/js/51.876e1cfd.js"><link rel="prefetch" href="/assets/js/6.87f02c74.js"><link rel="prefetch" href="/assets/js/7.fadbe260.js"><link rel="prefetch" href="/assets/js/8.d45b99a8.js"><link rel="prefetch" href="/assets/js/9.0c014273.js"><link rel="prefetch" href="/assets/js/vendors~docs-searchbar.9a2822a3.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b26ff90a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Welcome to the Meilisearch dev specifications!</span></a> <div class="links"><form id="search-form" role="search" class="meilisearch-search-wrapper search-box"><input id="meilisearch-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/specifications/text/specifications/text/0000-specification-template.html" class="nav-link">
  Specification
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/specifications/text/specifications/text/0000-specification-template.html" class="nav-link">
  Specification
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/specifications/text/0000-specification-template.html" class="sidebar-link">Specification template</a></li><li><a href="/specifications/text/0001-frontend-disable-prod.html" class="sidebar-link">Frontend disable prod</a></li><li><a href="/specifications/text/0001-script-based-tokenizer.html" class="sidebar-link">Script based tokenizer</a></li><li><a href="/specifications/text/0028-indexing-csv.html" class="sidebar-link">Indexing csv</a></li><li><a href="/specifications/text/0029-indexing-ndjson.html" class="sidebar-link">Indexing ndjson</a></li><li><a href="/specifications/text/0030-asc-desc-criterion.html" class="sidebar-link">Asc desc criterion</a></li><li><a href="/specifications/text/0032-distinct-attribute.html" class="sidebar-link">Distinct attribute</a></li><li><a href="/specifications/text/0033-logging.html" class="sidebar-link">Logging</a></li><li><a href="/specifications/text/0034-telemetry-policies.html" class="sidebar-link">Telemetry policies</a></li><li><a href="/specifications/text/0036-exactness-criterion.html" class="sidebar-link">Exactness criterion</a></li><li><a href="/specifications/text/0038-rename-attributes-for-faceting.html" class="sidebar-link">Rename attributes for faceting</a></li><li><a href="/specifications/text/0043-phrase-query.html" class="sidebar-link">Phrase query</a></li><li><a href="/specifications/text/0047-reset-stop-words-synonyms-settings-with-null.html" class="sidebar-link">Reset stop words synonyms settings with null</a></li><li><a href="/specifications/text/0048-rename-max-mdb-size-var.html" class="sidebar-link">Rename max mdb size var</a></li><li><a href="/specifications/text/0055-sort.html" class="sidebar-link">Sort</a></li><li><a href="/specifications/text/0059-geo-search.html" class="sidebar-link">Geo search</a></li><li><a href="/specifications/text/0060-tasks-api.html" class="sidebar-link">Tasks api</a></li><li><a href="/specifications/text/0061-error-format-and-definitions.html" class="sidebar-link">Error format and definitions</a></li><li><a href="/specifications/text/0077-words-position-limit.html" class="sidebar-link">Words position limit</a></li><li><a href="/specifications/text/0085-api-keys.html" class="sidebar-link">Api keys</a></li><li><a href="/specifications/text/0089-tenant-tokens.html" class="sidebar-link">Tenant tokens</a></li><li><a href="/specifications/text/0096-auto-batching.html" class="sidebar-link">Auto batching</a></li><li><a href="/specifications/text/0105-dumps-api.html" class="sidebar-link">Dumps api</a></li><li><a href="/specifications/text/0117-typo-tolerance-setting-api.html" class="sidebar-link">Typo tolerance setting api</a></li><li><a href="/specifications/text/0118-search-api.html" aria-current="page" class="active sidebar-link">Search api</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/specifications/text/0118-search-api.html#_1-summary" class="sidebar-link">1. Summary</a></li><li class="sidebar-sub-header"><a href="/specifications/text/0118-search-api.html#_2-motivation" class="sidebar-link">2. Motivation</a></li><li class="sidebar-sub-header"><a href="/specifications/text/0118-search-api.html#_3-functional-specification" class="sidebar-link">3. Functional Specification</a></li><li class="sidebar-sub-header"><a href="/specifications/text/0118-search-api.html#_2-technical-details" class="sidebar-link">2. Technical Details</a></li><li class="sidebar-sub-header"><a href="/specifications/text/0118-search-api.html#_3-future-possibilities" class="sidebar-link">3. Future Possibilities</a></li></ul></li><li><a href="/specifications/text/0119-instance-options.html" class="sidebar-link">Instance options</a></li><li><a href="/specifications/text/0121-data-types.html" class="sidebar-link">Data types</a></li><li><a href="/specifications/text/0123-displayed-attributes-setting-api.html" class="sidebar-link">Displayed attributes setting api</a></li><li><a href="/specifications/text/0123-distinct-attribute-setting-api.html" class="sidebar-link">Distinct attribute setting api</a></li><li><a href="/specifications/text/0123-filterable-attributes-setting-api.html" class="sidebar-link">Filterable attributes setting api</a></li><li><a href="/specifications/text/0123-ranking-rules-setting-api.html" class="sidebar-link">Ranking rules setting api</a></li><li><a href="/specifications/text/0123-searchable-attributes-setting-api.html" class="sidebar-link">Searchable attributes setting api</a></li><li><a href="/specifications/text/0123-settings-api.html" class="sidebar-link">Settings api</a></li><li><a href="/specifications/text/0123-sortable-attributes-setting-api.html" class="sidebar-link">Sortable attributes setting api</a></li><li><a href="/specifications/text/0123-stop-words-setting-api.html" class="sidebar-link">Stop words setting api</a></li><li><a href="/specifications/text/0123-synonyms-setting-api.html" class="sidebar-link">Synonyms setting api</a></li><li><a href="/specifications/text/0124-documents-api.html" class="sidebar-link">Documents api</a></li><li><a href="/specifications/text/0132-indexes-api.html" class="sidebar-link">Indexes api</a></li><li><a href="/specifications/text/0134-stats-api.html" class="sidebar-link">Stats api</a></li><li><a href="/specifications/text/157-faceting-setting-api.html" class="sidebar-link">Aceting setting api</a></li><li><a href="/specifications/text/157-pagination-setting-api.html" class="sidebar-link">Agination setting api</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="search-api"><a href="#search-api" class="header-anchor">#</a> Search API</h1> <h2 id="_1-summary"><a href="#_1-summary" class="header-anchor">#</a> 1. Summary</h2> <p>The search endpoints retrieve documents from an index. Their returned documents are considered relevant based on the settings of the index and the provided search parameters.</p> <h2 id="_2-motivation"><a href="#_2-motivation" class="header-anchor">#</a> 2. Motivation</h2> <p>N/A</p> <h2 id="_3-functional-specification"><a href="#_3-functional-specification" class="header-anchor">#</a> 3. Functional Specification</h2> <p>Meilisearch exposes 2 routes to perform search requests:</p> <ul><li><p>GET <code>indexes/:index_uid/search</code></p></li> <li><p>POST <code>indexes/:index_uid/search</code></p></li> <li><p>🔴 If the index does not exist, the API returns an <a href="/specifications/text/0061-error-format-and-definitions.html#index_not_found">index_not_found</a> error.</p></li></ul> <p>If a master key is used to secure a Meilisearch instance, the auth layer returns the following errors:</p> <ul><li>🔴 Accessing these routes without the <code>Authorization</code> header returns a <a href="/specifications/text/0061-error-format-and-definitions.html#missing_authorization_header">missing_authorization_header</a> error.</li> <li>🔴 Accessing these routes with a key that does not have permissions (i.e. other than the master key) returns an <a href="/specifications/text/0061-error-format-and-definitions.html#invalid_api_key">invalid_api_key</a> error.</li></ul> <p><code>POST</code> HTTP verb errors:</p> <ul><li>🔴 Omitting the Content-Type header returns a <a href="/specifications/text/0061-error-format-and-definitions.html#missing_content_type">missing_content_type</a> error.</li> <li>🔴 Sending an empty Content-Type returns an <a href="/specifications/text/0061-error-format-and-definitions.html#invalid_content_type">invalid_content_type</a> error.</li> <li>🔴 Sending a different Content-Type than <code>application/json</code> returns an <a href="/specifications/text/0061-error-format-and-definitions.html#invalid_content_type">invalid_content_type</a> error.</li> <li>🔴 Sending an empty payload returns a <a href="/specifications/text/0061-error-format-and-definitions.html#missing_payload">missing_payload</a> error.</li> <li>🔴 Sending an invalid JSON payload returns a <a href="/specifications/text/0061-error-format-and-definitions.html#malformed_payload">malformed_payload</a> error.</li></ul> <h3 id="_3-1-search-payload-parameters"><a href="#_3-1-search-payload-parameters" class="header-anchor">#</a> 3.1. Search Payload Parameters</h3> <table><thead><tr><th>Field</th> <th>Type</th> <th>Required</th></tr></thead> <tbody><tr><td><a href="#311-q"><code>q</code></a></td> <td>String</td> <td>False</td></tr> <tr><td><a href="#312-filter"><code>filter</code></a></td> <td>Array of String - String</td> <td>False</td></tr> <tr><td><a href="#313-sort"><code>sort</code></a></td> <td>Array of String - String</td> <td>False</td></tr> <tr><td><a href="#314-facets"><code>facets</code></a></td> <td>Array of String - String</td> <td>False</td></tr> <tr><td><a href="#315-limit"><code>limit</code></a></td> <td>Integer</td> <td>False</td></tr> <tr><td><a href="#316-offset"><code>offset</code></a></td> <td>Integer</td> <td>False</td></tr> <tr><td><a href="#317-attributestoretrieve"><code>attributesToRetrieve</code></a></td> <td>Array of String - String</td> <td>False</td></tr> <tr><td><a href="#318-attributestohighlight"><code>attributesToHighlight</code></a></td> <td>Array of String - String</td> <td>False</td></tr> <tr><td><a href="#319-highlightpretag"><code>highlightPreTag</code></a></td> <td>String</td> <td>False</td></tr> <tr><td><a href="#3110-highlightposttag"><code>highlightPostTag</code></a></td> <td>String</td> <td>False</td></tr> <tr><td><a href="#3111-attributestocrop"><code>attributesToCrop</code></a></td> <td>Array of String - String</td> <td>False</td></tr> <tr><td><a href="#3112-croplength"><code>cropLength</code></a></td> <td>Integer</td> <td>False</td></tr> <tr><td><a href="#3113-cropmarker"><code>cropMarker</code></a></td> <td>String</td> <td>False</td></tr> <tr><td><a href="#3114-showmatchesposition"><code>showMatchesPosition</code></a></td> <td>Boolean</td> <td>False</td></tr></tbody></table> <h4 id="_3-1-1-q"><a href="#_3-1-1-q" class="header-anchor">#</a> 3.1.1. <code>q</code></h4> <ul><li>Type: String</li> <li>Required: False</li> <li>Default: <code>null</code></li></ul> <p><code>q</code> contains the terms to search within the index documents.</p> <ul><li>🔴 Sending a value with a different type than <code>String</code> or <code>null</code> for <code>q</code> returns a <a href="/specifications/text/0061-error-format-and-definitions.html#bad_request">bad_request</a> error.</li></ul> <blockquote><p>When q isn't specified, Meilisearch performs a <strong>placeholder search</strong>. A placeholder search returns all searchable documents in an index, modified by any search parameters used and sorted by that index's custom ranking rules. If the index has no sort search parameter or custom ranking rules, the results are returned in the order of their internal database position.</p></blockquote> <blockquote><p>Meilisearch only considers the first ten words of any given search query to deliver a fast search-as-you-type experience.</p></blockquote> <blockquote><p><code>q</code> supports the <a href="/specifications/text/0043-phrase-query.html">Phrase Query</a> expression.</p></blockquote> <ul><li>🔴 Sending a value with a different type than <code>String</code> or <code>null</code> for <code>q</code> returns an <a href="/specifications/text/0061-error-format-and-definitions.html#bad_request">bad_request</a> error.</li></ul> <h4 id="_3-1-2-filter"><a href="#_3-1-2-filter" class="header-anchor">#</a> 3.1.2. <code>filter</code></h4> <ul><li>Type: Array of String (POST) | String (POST/GET)</li> <li>Required: False</li> <li>Default: <code>[]|null</code></li></ul> <p><code>filter</code> contains a filter expression written as a string or an array of strings. It permits to refine search results.</p> <p>Attributes used as filter criteria must be added to the <code>filterableAttributes</code> list of an index settings. See <a href="/specifications/text/0123-filterable-attributes-setting-api.html">Filterable Attributes Setting API</a>.</p> <ul><li>🔴 Sending a value with a different type than <code>Array of String</code>(POST), <code>String</code>(GET) or <code>null</code> for <code>filter</code> returns an <a href="/specifications/text/0061-error-format-and-definitions.html#invalid_filter">invalid_filter</a> error.</li> <li>🔴 Sending an invalid syntax for <code>filter</code> returns an <a href="/specifications/text/0061-error-format-and-definitions.html#invalid_filter">invalid_filter</a> error.</li> <li>🔴 Sending a field not defined as a <code>filterableAttributes</code> for <code>filter</code> returns an <a href="/specifications/text/0061-error-format-and-definitions.html#invalid_filter">invalid_filter</a> error.</li></ul> <h5 id="_3-1-2-1-supported-operators-and-syntaxes"><a href="#_3-1-2-1-supported-operators-and-syntaxes" class="header-anchor">#</a> 3.1.2.1. Supported Operators And Syntaxes.</h5> <h6 id="_3-1-2-1-1-supported-operators"><a href="#_3-1-2-1-1-supported-operators" class="header-anchor">#</a> 3.1.2.1.1. Supported Operators</h6> <ul><li><code>&lt;</code>, <code>&lt;=</code>, <code>&gt;</code>, <code>&gt;=</code>, <code>TO</code>; only operate on number values. MeiliSearch returns only documents that have numbers in this field.</li> <li><code>=</code>, <code>!=</code>/<code>NOT</code>; operate on string and number values. MeiliSearch returns only documents that have numbers, strings, or arrays of strings in this field.</li> <li><code>AND</code>/<code>OR</code>; permits to cumulate several operations.</li></ul> <p><code>filter</code> cannot operate on <code>null</code>, arrays of &quot;undefined elements&quot; (ex: array of <code>null</code>).</p> <h6 id="_3-1-2-1-2-supported-syntaxes"><a href="#_3-1-2-1-2-supported-syntaxes" class="header-anchor">#</a> 3.1.2.1.2. Supported Syntaxes</h6> <p>Three syntaxes will be accepted for the <code>filter</code> parameter during search. <code>String syntax</code>, <code>Array syntax</code> and <code>Mixed syntax</code>.</p> <p><strong>String syntax</strong></p> <p>The string syntax uses operators combined with parentheses to express a search filter.</p> <p>Example:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;filter&quot;</span><span class="token operator">:</span> <span class="token string">&quot;(genres = Comedy OR genres = Romance) AND director = 'Mati Diop'&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>Array syntax</strong></p> <p>The array syntax uses dimensional array to express logical connectives.</p> <ul><li>Inner arrays elements are connected by an <code>OR</code> operator (e.g. [[&quot;genres:Comedy&quot;, &quot;genres:Romance&quot;]]).</li> <li>Outer arrays elements are connected by an <code>AND</code> operator (e.g. [&quot;genres:Romance&quot;, &quot;director:Mati Diop&quot;]).</li></ul> <p>Example:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;genres = Comedy&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;genres = Romance&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&quot;director = 'Mati Diop'&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>Mixed syntax</strong></p> <p>The mixed syntax can mix string and array syntaxes.</p> <p>Let's say that we want to translate</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;filter&quot;</span><span class="token operator">:</span> <span class="token string">&quot;((genres = Comedy AND genres = Romance) OR genres = Action) AND director != 'Mati Diop'&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Example:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;genres = Comedy AND genres = Romance&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;genres = Action&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&quot;NOT director = comedy&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>Note that string values that are longer than a single word need to be enclosed by quote. <code>&quot;director = Mati Diop&quot;</code> will lead to a parsing error. The valid syntax is <code>&quot;director = 'Mati Diop'&quot;</code>.</p></blockquote> <h4 id="_3-1-3-sort"><a href="#_3-1-3-sort" class="header-anchor">#</a> 3.1.3. <code>sort</code></h4> <ul><li>Type: Array of String (POST) | String (GET)</li> <li>Required: False</li> <li>Default: <code>[]|null</code></li></ul> <p><code>sort</code> contains a sort expression written as a string or an array of strings. It sorts the search results at query time according to the specified attributes and indicated order.</p> <p>Attributes used as sort criteria must be added to the `sortableAttributes list of an index settings. See <a href="/specifications/text/0123-sortable-attributes-setting-api.html">Sortable Attributes Setting API</a>.</p> <ul><li>🔴 Sending a value with a different type than <code>Array of String</code>(POST), <code>String</code>(GET) or <code>null</code> for <code>sort</code> returns a <a href="/specifications/text/0061-error-format-and-definitions.html#bad_request">bad_request</a> error.</li> <li>🔴 Sending an invalid syntax for <code>sort</code> returns an <a href="/specifications/text/0061-error-format-and-definitions.html#invalid_sort">invalid_sort</a> error.</li> <li>🔴 Sending a field not defined as a <code>sortableAttributes</code> for <code>sort</code> returns an <a href="/specifications/text/0061-error-format-and-definitions.html#invalid_sort">invalid_sort</a> error.</li></ul> <blockquote><p>See <a href="/specifications/text/0055-sort.html">Sort</a></p></blockquote> <h4 id="_3-1-4-facets"><a href="#_3-1-4-facets" class="header-anchor">#</a> 3.1.4. <code>facets</code></h4> <ul><li>Type: Array of String (POST) | String (GET)</li> <li>Required: False</li> <li>Default: <code>[]|null</code></li></ul> <p><code>facets</code> permits to specify facets to be computed for the current search query.</p> <p>It returns the number of documents matching the current search query for each specified facet.</p> <p>This parameter can take two values:</p> <ul><li>An array of attributes: <code>facets=[&quot;attributeA&quot;, &quot;attributeB&quot;, …]</code></li> <li>A wildcard <code>&quot;*&quot;</code> — this returns a count for all facets present in <code>filterableAttributes</code></li></ul> <p>Attributes used in <code>facets</code> must be added to the <code>filterableAttributes</code> list of an index settings. See <a href="/specifications/text/0123-filterable-attributes-setting-api.html">Filterable Attributes Setting API</a>.</p> <ul><li>🔴 Sending a value with a different type than <code>Array of String</code>(POST), <code>String</code>(GET) or <code>null</code> for <code>facets</code> returns a <a href="/specifications/text/0061-error-format-and-definitions.html#bad_request">bad_request</a> error.</li> <li>🔴 Sending a field not defined as a <code>filterableAttributes</code> for <code>facets</code> returns a <a href="/specifications/text/0061-error-format-and-definitions.html#bad_request">bad_request</a> error.</li></ul> <p>The distribution of the different facets is returned in the <code>facetDistribution</code> response parameter.</p> <h4 id="_3-1-5-limit"><a href="#_3-1-5-limit" class="header-anchor">#</a> 3.1.5. <code>limit</code></h4> <ul><li>Type: Integer</li> <li>Required: False</li> <li>Default: <code>20</code></li></ul> <p>Sets the maximum number of documents to be returned for the search query.</p> <ul><li>🔴 Sending a value with a different type than <code>Integer</code> for <code>limit</code> returns a <a href="/specifications/text/0061-error-format-and-definitions.html#bad_request">bad_request</a> error.</li></ul> <h4 id="_3-1-6-offset"><a href="#_3-1-6-offset" class="header-anchor">#</a> 3.1.6. <code>offset</code></h4> <ul><li>Type: Integer</li> <li>Required: False</li> <li>Default: <code>0</code></li></ul> <p>Sets the starting point in the search results, effectively skipping over a given number of documents.</p> <ul><li>🔴 Sending a value with a different type than <code>Integer</code> for <code>offset</code> returns a <a href="/specifications/text/0061-error-format-and-definitions.html#bad_request">bad_request</a> error.</li></ul> <h4 id="_3-1-7-attributestoretrieve"><a href="#_3-1-7-attributestoretrieve" class="header-anchor">#</a> 3.1.7. <code>attributesToRetrieve</code></h4> <ul><li>Type: Array of String (POST) | String (GET)</li> <li>Required: False</li> <li>Default: <code>[&quot;*&quot;]</code>, meaning all the attributes</li></ul> <p>Configures which attributes will be retrieved in the returned documents.</p> <p>If no value is specified, the default value of <code>attributesToRetrieve</code> is used (<code>[&quot;*&quot;]</code>). This corresponds to the <code>displayedAttributes</code> index setting, which by default contains all attributes found in the documents.</p> <blockquote><p>If an attribute is missing from <code>displayedAttributes</code> index setting, <code>attributesToRetrieve</code> silently ignore it, and the field doesn't appear in the returned search results.</p></blockquote> <ul><li>🔴 Sending a value with a different type than <code>Array of String</code>(POST), <code>String</code>(GET) or <code>null</code> for <code>attributesToRetrieve</code> returns a <a href="/specifications/text/0061-error-format-and-definitions.html#bad_request">bad_request</a> error.</li></ul> <h4 id="_3-1-8-attributestohighlight"><a href="#_3-1-8-attributestohighlight" class="header-anchor">#</a> 3.1.8. <code>attributesToHighlight</code></h4> <ul><li>Type: Array of String (POST) | String(GET)</li> <li>Required: False</li> <li>Default: <code>[]|null</code></li></ul> <p>Configures which fields may have highlighted parts, given that they match the requested query terms (i.e. the terms in the <a href="#311-q"><code>q</code></a> search parameter). Pre/post highlighting tags are applied around each word corresponding to a query term.</p> <p>If <code>attributesToHighlight</code> is present in the search query, the search results will include a <code>_formatted</code> object containing the attributes and their highlighted parts. For more detailed regarding the <code>_formatted</code> behavior, see the <a href="#32112-formatted">3.2.1.1.2. <code>_formatted</code></a> section.</p> <p>If <code>&quot;*&quot;</code> is provided as a value (<code>attributesToHighlight=[&quot;*&quot;]</code>), all the attributes present in <code>displayedAttributes</code> setting will be highlighted.</p> <p>Highlighted parts are surrounded by the <a href="#319-highlightpretag"><code>highlightPreTag</code></a> and <a href="#3110-highlightposttag"><code>highlightPostTag</code></a> parameters.</p> <p><code>attributesToHighlight</code> only works on values of the following types: <code>string</code>, <code>number</code>, <code>array</code>, <code>object</code>. When highlighted, number attributes are transformed to string.</p> <ul><li>🔴 Sending a value with a different type than <code>Array[String]</code>(POST), <code>String</code>(GET) or <code>null</code> for <code>attributesToHighlight</code> returns a <a href="/specifications/text/0061-error-format-and-definitions.html#bad_request">bad_request</a> error.</li></ul> <h5 id="_3-1-8-1-searchableattributes"><a href="#_3-1-8-1-searchableattributes" class="header-anchor">#</a> 3.1.8.1. searchableAttributes</h5> <p>Attributes not defined in the <code>searchableAttributes</code> index setting are also highlighted if assigned to <code>attributesToHighlight</code>.</p> <h5 id="_3-1-8-2-stopwords"><a href="#_3-1-8-2-stopwords" class="header-anchor">#</a> 3.1.8.2. stopWords</h5> <p>Attributes defined in the <code>stopWords</code> index setting are also highlighted if matched.</p> <h5 id="_3-1-8-3-tokenizer-separators"><a href="#_3-1-8-3-tokenizer-separators" class="header-anchor">#</a> 3.1.8.3. Tokenizer Separators</h5> <p>Tokenizer separators are not highlighted.</p> <h5 id="_3-1-8-4-synonyms"><a href="#_3-1-8-4-synonyms" class="header-anchor">#</a> 3.1.8.4. synonyms</h5> <p>Synonyms are also highlighted.</p> <h4 id="_3-1-9-highlightpretag"><a href="#_3-1-9-highlightpretag" class="header-anchor">#</a> 3.1.9. <code>highlightPreTag</code></h4> <ul><li>Type: String</li> <li>Required: False</li> <li>Default: <code>&quot;&lt;em&gt;&quot;</code></li></ul> <p>Specifies the string to put <strong>before</strong> every highlighted query terms.</p> <p>This parameter is applied to the fields configured in <code>attributesToHighlight</code>. If there are none, this parameter has no effect. See <a href="#318-attributestohighlight">3.1.8. <code>attributesToHighlight</code></a> section.</p> <ul><li>🔴 Sending a value with a different type than <code>String</code> for <code>highlightPreTag</code> returns a <a href="/specifications/text/0061-error-format-and-definitions.html#bad_request">bad_request</a> error.</li></ul> <p>If <code>attributesToHighlight</code> is omitted while <code>highlightPreTag</code> is specified, there is no error.</p> <h4 id="_3-1-10-highlightposttag"><a href="#_3-1-10-highlightposttag" class="header-anchor">#</a> 3.1.10. <code>highlightPostTag</code></h4> <ul><li>Type: String</li> <li>Required: False</li> <li>Default: <code>&quot;&lt;/em&gt;&quot;</code></li></ul> <p>Specifies the string to put <strong>after</strong> the highlighted query terms.</p> <p>This parameter is applied to the fields from <code>attributesToHighlight</code>. If there are none, this parameter has no effect. See <a href="#318-attributestohighlight">3.1.8. <code>attributesToHighlight</code></a> section.</p> <ul><li>🔴 Sending a value with a different type than <code>String</code> for <code>highlightPostTag</code> returns a <a href="/specifications/text/0061-error-format-and-definitions.html#bad_request">bad_request</a> error.</li></ul> <p>If <code>attributesToHighlight</code> is omitted while <code>highlightPostTag</code> is specified, there is no error.</p> <h4 id="_3-1-11-attributestocrop"><a href="#_3-1-11-attributestocrop" class="header-anchor">#</a> 3.1.11. <code>attributesToCrop</code></h4> <ul><li>Type: Array[String]|String</li> <li>Required: False</li> <li>Default: <code>[]|null</code></li></ul> <p>Defines document attributes to be cropped. Cropped attributes have their values shortened around query terms.</p> <p>If <code>attributesToCrop</code> is present in the search query, the search results will include a <code>_formatted</code> object containing the attributes and their cropped parts. For more detailed regarding the <code>_formatted</code> behavior, see the <a href="#32112-formatted">3.2.1.1.2. <code>_formatted</code></a> section.</p> <p>If <code>&quot;*&quot;</code> is provided as a value (<code>attributesToCrop=[&quot;*&quot;]</code>), all the attributes present in <code>displayedAttributes</code> setting will be cropped.</p> <p>The number of words contained in the cropped value is defined by the <code>cropLength</code> parameter. See <a href="#3112-croplength">3.1.1.12. <code>cropLength</code></a> section.</p> <p>The value of <code>cropLength</code> can be customized per attribute. See <a href="#31121-custom-croplength-defined-per-attribute">3.1.12.1. Custom <code>cropLength</code> Defined Per Cropped Attribute</a> section.</p> <p>The engine adds a marker by default in front of and/or behind the part selected by the cropper. This marker is customizable. See <a href="#3113-cropmarker">3.1.13. <code>cropMarker</code></a> section.</p> <ul><li>🔴 Sending a value with a different type than <code>Array[String]</code>(POST), <code>String</code>(GET) or <code>null</code> for <code>attributesToCrop</code> returns a <a href="/specifications/text/0061-error-format-and-definitions.html#bad_request">bad_request</a> error.</li></ul> <h5 id="_3-1-11-2-searchableattributes"><a href="#_3-1-11-2-searchableattributes" class="header-anchor">#</a> 3.1.11.2. searchableAttributes</h5> <p>Attributes configured in <code>attributesToCrop</code> are cropped even if not present in the <code>searchableAttributes</code> index setting.</p> <h5 id="_3-1-11-3-stopwords"><a href="#_3-1-11-3-stopwords" class="header-anchor">#</a> 3.1.11.3. stopWords</h5> <p>Terms defined in the <code>stopWords</code> index setting are counted as words regarding <code>cropLength</code>.</p> <h5 id="_3-1-11-3-tokenizer-separators"><a href="#_3-1-11-3-tokenizer-separators" class="header-anchor">#</a> 3.1.11.3. Tokenizer Separators</h5> <p>Tokenizer separators aren't counted as words regarding <code>cropLength</code>.</p> <h4 id="_3-1-12-croplength"><a href="#_3-1-12-croplength" class="header-anchor">#</a> 3.1.12. <code>cropLength</code></h4> <ul><li>Type: Integer</li> <li>Required: False</li> <li>Default: <code>10</code></li></ul> <p>Sets the total number of <strong>words</strong> to keep for the cropped part of an attribute specified in the <code>attributesToCrop</code> parameter. It means that if <code>10</code> is set for <code>cropLength</code>, the cropped part returned in <code>_formatted</code> will only be 10 words long.</p> <p>This parameter is applied to the fields from <code>attributesToCrop</code>. If there are none, this parameter has no effect. See <a href="#3111-attributestocrop">3.1.11. <code>attributesToCrop</code></a> section.</p> <p>Sending a <code>0</code> value deactivates the cropping unless a custom crop length is defined for an attribute inside <code>attributesToCrop</code>.</p> <ul><li>🔴 Sending a value with a different type than <code>Integer</code> for <code>cropLength</code> returns a <a href="/specifications/text/0061-error-format-and-definitions.html#bad_request">bad_request</a> error.</li></ul> <h5 id="_3-1-12-1-custom-croplength-defined-per-attribute"><a href="#_3-1-12-1-custom-croplength-defined-per-attribute" class="header-anchor">#</a> 3.1.12.1. Custom <code>cropLength</code> Defined Per Attribute.</h5> <p>Optionally, indicating a custom crop length for any of the listed attributes is possible:</p> <p><code>&quot;attributesToCrop&quot;:[&quot;attributeNameA:15&quot;, &quot;attributeNameB:30&quot;]</code></p> <p>A custom crop length set in this way has priority over the <code>cropLength</code> parameter.</p> <h5 id="_3-1-12-2-examples"><a href="#_3-1-12-2-examples" class="header-anchor">#</a> 3.1.12.2 Examples</h5> <h6 id="_3-1-12-1-1-extending-around"><a href="#_3-1-12-1-1-extending-around" class="header-anchor">#</a> 3.1.12.1.1. Extending around</h6> <p>Given an attribute defined in <code>attributesToCrop</code> containing:</p> <p><code>&quot;In his ravenous hatred he found no peace, and with boiling blood he scoured the umbral plains, seeking vengence afgainst the dark lords who had robbed him.&quot;</code></p> <p>With <code>croplength</code> defined as <code>5</code> and <code>q</code> defined as <code>boiling blood</code>, the cropped value will be:</p> <p><code>&quot;…and with boiling blood he…&quot;</code></p> <p>Cropped query terms are counted as a word regarding <code>cropLength</code>.</p> <p>Sending more query terms than the <code>cropLength</code> value has no impact. The cropped part will contain the <code>cropLength</code> number.</p> <h6 id="_3-1-12-1-2-keeping-a-phrase-context"><a href="#_3-1-12-1-2-keeping-a-phrase-context" class="header-anchor">#</a> 3.1.12.1.2. Keeping a phrase context</h6> <p>After Meilisearch has chosen the best possible match window (some number of words &lt; <code>cropLength</code>), it will add words from before or after the match window until the total number is equal to <code>cropLength</code>. In doing so, it will attempt to add context to the match window by choosing words from the same sentence(s) where the match window occurs.</p> <p>For instance, for the matching word <code>Split</code> the text:</p> <p><code>&quot;Natalie risk her future. Split The World is a book written by Emily Henry. I never read it.&quot;</code></p> <p>will be cropped like:</p> <p><code>…Split The World is a book written by Emily Henry…</code></p> <p>and not like:</p> <p><code>Natalie risk her future. Split The World is a book…</code></p> <h4 id="_3-1-13-cropmarker"><a href="#_3-1-13-cropmarker" class="header-anchor">#</a> 3.1.13. <code>cropMarker</code></h4> <ul><li>Type: String</li> <li>Required: False</li> <li>Default: <code>&quot;…&quot;</code> (U+2026)</li></ul> <p>Sets which string to add before and/or after the cropped text. See <a href="#3111-attributestocrop">3.1.11. <code>attributesToCrop</code></a> section.</p> <p>The specified crop marker is applied by following rules outline in section <a href="#31131-applying-cropmarker">3.1.13.1. Applying <code>cropMarker</code></a>.</p> <p>Specifying <code>cropMarker</code> to <code>&quot;&quot;</code> or <code>null</code> implies that no marker will be applied to the cropped part.</p> <p>This parameter is applied to the fields configured in <code>attributesToCrop</code>. If there are none, this parameter has no effect. See <a href="#3111-attributestocrop">3.1.11. <code>attributesToCrop</code></a> section.</p> <ul><li>🔴 Sending a value with a different type than <code>String</code> or <code>null</code> for <code>cropMarker</code> returns a <a href="/specifications/text/0061-error-format-and-definitions.html#bad_request">bad_request</a> error.</li></ul> <h5 id="_3-1-13-1-applying-cropmarker"><a href="#_3-1-13-1-applying-cropmarker" class="header-anchor">#</a> 3.1.13.1. Applying <code>cropMarker</code></h5> <h6 id="_3-1-13-1-1-matched-part-to-be-cropped"><a href="#_3-1-13-1-1-matched-part-to-be-cropped" class="header-anchor">#</a> 3.1.13.1.1. Matched Part To Be Cropped</h6> <p>The cropping algorithm tries to match the window with the highest density of query terms within the <code>cropLength</code> limit.</p> <p>The cropping algorithm tries to find the crop window that contains the most relevant matches.</p> <ol><li>That has the highest count of unique matches</li></ol> <p>For example, for the query terms <code>split the world</code>, then the interval <code>the split the split the</code> has <code>5</code> matches but only <code>2</code> unique matches (<code>1</code> for <code>split</code> and <code>1</code> for <code>the</code>) where the interval <code>split of the world</code> has <code>3</code> matches and <code>3</code> unique matches. So the interval <code>split of the world</code> is considered better.</p> <ol start="2"><li>That have the minimum distance between matches</li></ol> <p>For example, for the query terms <code>split the world</code>, then the interval <code>split of the world</code> has a distance of <code>3</code> (<code>2</code> between <code>split</code> and <code>the</code>, and <code>1</code> between <code>the</code> and <code>world</code>) where the interval <code>split the world</code> has a distance of <code>2</code>. So the interval <code>split the world</code> is considered better.</p> <ol start="3"><li>That have the highest count of ordered matches</li></ol> <p>For example, for the query terms <code>split the world</code>, then the interval <code>the world split</code> has <code>2</code> ordered words where the interval <code>split the world</code> has <code>3</code>. So the interval <code>split the world</code> is considered better.</p> <p>Only one cropped part from an attribute is returned.</p> <p>If no part is found when selecting a part to be cropped, the returned value in <code>_formatted</code> will start at the beginning of the attribute and include a number of words equal to <code>cropLength</code>.</p> <h6 id="_3-1-13-1-2-positioning-markers"><a href="#_3-1-13-1-2-positioning-markers" class="header-anchor">#</a> 3.1.13.1.2. Positioning Markers</h6> <p>If the cropped part has been matched against query terms and contains the beginning of the attribute to be cropped, the <code>cropMarker</code> is not placed to the left of the cropped part.</p> <p>If the cropped part has been matched against query terms and contains the end of the attribute to be cropped, the <code>cropMarker</code> is not placed to the right of the cropped part.</p> <h4 id="_3-1-14-showmatchesposition"><a href="#_3-1-14-showmatchesposition" class="header-anchor">#</a> 3.1.14. <code>showMatchesPosition</code></h4> <ul><li>Type: Boolean</li> <li>Required: False</li> <li>Default: <code>false</code></li></ul> <p>Adds a <code>_matchesPosition</code> object to the search response that contains the location of each occurrence of queried terms across all fields. The given positions are in bytes.</p> <p>It's useful when more control is needed than offered by the built-in highlighting/cropping features.</p> <ul><li>🔴 Sending a value with a different type than <code>Boolean</code> or <code>null</code> for <code>showMatchesPosition</code> returns a <a href="/specifications/text/0061-error-format-and-definitions.html#bad_request">bad_request</a> error.</li></ul> <h3 id="_3-2-search-response-properties"><a href="#_3-2-search-response-properties" class="header-anchor">#</a> 3.2. Search Response Properties</h3> <table><thead><tr><th>Field</th> <th>Type</th> <th>Required</th></tr></thead> <tbody><tr><td><a href="#321-hits"><code>hits</code></a></td> <td>Array[Hit]</td> <td>True</td></tr> <tr><td><a href="#322-limit"><code>limit</code></a></td> <td>Integer</td> <td>True</td></tr> <tr><td><a href="#323-offset"><code>offset</code></a></td> <td>Integer</td> <td>True</td></tr> <tr><td><a href="#324-estimatedTotalHits"><code>estimatedTotalHits</code></a></td> <td>Integer</td> <td>True</td></tr> <tr><td><a href="#325-facetdistribution"><code>facetDistribution</code></a></td> <td>Object</td> <td>False</td></tr> <tr><td><a href="#326-processingtimems"><code>processingTimeMs</code></a></td> <td>Integer</td> <td>True</td></tr> <tr><td><a href="#327-query"><code>query</code></a></td> <td>String</td> <td>True</td></tr></tbody></table> <h4 id="_3-2-1-hits"><a href="#_3-2-1-hits" class="header-anchor">#</a> 3.2.1. <code>hits</code></h4> <ul><li>Type: Array[Hit]</li> <li>Required: True</li></ul> <p>Results of the search query as an array of documents.</p> <blockquote><p>Hit object represents a matched document as a search result.</p></blockquote> <blockquote><p>The search parameters <code>attributesToRetrieve</code> influence the returned payload for a hit. See <a href="#317-attributestoretrieve">3.1.7. <code>attributesToRetrieve</code></a> section.</p></blockquote> <p>A search result can contain special properties. See <a href="#3211-hits-special-properties">3.2.1.1. <code>hit</code> Special Properties</a> section.</p> <h5 id="_3-2-1-1-hit-special-properties"><a href="#_3-2-1-1-hit-special-properties" class="header-anchor">#</a> 3.2.1.1. <code>hit</code> Special Properties</h5> <table><thead><tr><th>Field</th> <th>Type</th> <th>Required</th></tr></thead> <tbody><tr><td><a href="#32111-geodistance"><code>_geoDistance</code></a></td> <td>Integer</td> <td>False</td></tr> <tr><td><a href="#32112-formatted"><code>_formatted</code></a></td> <td>Object</td> <td>False</td></tr> <tr><td><a href="#32113-matchesposition"><code>_matchesPosition</code></a></td> <td>Object</td> <td>False</td></tr></tbody></table> <h6 id="_3-2-1-1-1-geodistance"><a href="#_3-2-1-1-1-geodistance" class="header-anchor">#</a> 3.2.1.1.1. <code>_geoDistance</code></h6> <ul><li>Type: Integer</li> <li>Required: False</li></ul> <p>Search queries using <code>_geoPoint</code> returns a <code>_geoDistance</code> field containing the distance in meters between the document <code>_geo</code> coordinates and the specified <code>_geoPoint</code>.</p> <blockquote><p>See <a href="/specifications/text/0059-geo-search.html">GeoSearch</a></p></blockquote> <h6 id="_3-2-1-1-2-formatted"><a href="#_3-2-1-1-2-formatted" class="header-anchor">#</a> 3.2.1.1.2. <code>_formatted</code></h6> <ul><li>Type: Object</li> <li>Required: False</li></ul> <p><code>_formatted</code> is an object returned in the search response, only if at least one of the following paramaters has been set in the search query:</p> <ul><li><code>attributesToHighlight</code></li> <li><code>attributesToCrop</code></li></ul> <p>If <code>attributesToHighlight</code> and <code>attributesToCrop</code> are not set, <code>_formatted</code> is not returned.</p> <p>This <code>_formatted</code> object will be present in each returned document in the <code>hits</code> field.</p> <p>Example:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;attributesToCrop&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
            <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Pride and Prejudice&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;_formatted&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Pride and Prejudice&quot;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">456</span><span class="token punctuation">,</span>
            <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Le Petit Prince&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;_formatted&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;456&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Le Petit Prince&quot;</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    ...
<span class="token punctuation">}</span>
</code></pre></div><p>Which attributes are present in <code>_formatted</code>?</p> <p><em>Remember the main rule: <code>_formatted</code> is only present if <code>attributesToHighlight</code> or <code>attributesToCrop</code> is set.</em></p> <p>The <code>_formatted</code> object contains attributes coming from the original document, depending on the parameters the users set during the search query. Indeed, <strong><code>_formatted</code> contains all the attributes present in <code>attributesToRetrieve</code>, <code>attributesToHighlight</code>, and <code>attributesToCrop</code> combined</strong>.</p> <p>Knowing the default value of <code>attributesToRetrieve</code> is <code>[&quot;*&quot;]</code> (so all the attributes present in <code>displayedAttributes</code>), if no <code>attributesToRetrieve</code> are set in the search query, <code>_formatted</code> will return all the <code>displayedAttributes</code>.</p> <p>Returning attributes in the <code>_formatted</code> object does not mean these attributes will be necessarily highlighted or cropped, see the next point.</p> <p>Which attributes are highlighted or cropped in <code>_formatted</code>?</p> <p>No matter which attributes are retrieved in <code>_formatted</code> (according to the previous section &quot;Which attributes are present in <code>_formatted</code>?&quot;):</p> <ul><li>Only the attributes present in <code>attributesToHighlight</code> are highlighted.</li> <li>Only the attributes present in <code>attributesToCrop</code> are cropped.</li> <li>Attributes present in both are cropped and highlighted at the same time.</li></ul> <p>Some edge cases:</p> <ul><li>If cumulated fields in <code>attributesToHighlight</code> and <code>attributesToCrop</code> resolve to only having non-existent fields, <code>_formatted</code> is not returned.</li></ul> <p>Some examples:
<em>The examples work the same with <code>attributesToCrop</code></em></p> <p>Example 1:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;q&quot;</span><span class="token operator">:</span> <span class="token string">&quot;t&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;attributesToHighlight&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;The Hobbit&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;author&quot;</span><span class="token operator">:</span> <span class="token string">&quot;J. R. R. Tolkien&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;_formatted&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&lt;em&gt;T&lt;/em&gt;he Hobbit&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;author&quot;</span><span class="token operator">:</span> <span class="token string">&quot;J. R. R. Tolkien&quot;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    ...
<span class="token punctuation">}</span>
</code></pre></div><p>-&gt; All the attributes (so <code>id</code>, <code>title</code> and <code>author</code>) are returned in <code>_formatted</code> because by default <code>attributesToRetrieve</code> is set to <code>[&quot;*&quot;]</code>.
-&gt; Only <code>title</code> is highlighted.</p> <p>Example 2:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;q&quot;</span><span class="token operator">:</span> <span class="token string">&quot;t&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;attributesToHighlight&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;*&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;The Hobbit&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;author&quot;</span><span class="token operator">:</span> <span class="token string">&quot;J. R. R. Tolkien&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;_formatted&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&lt;em&gt;T&lt;/em&gt;he Hobbit&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;author&quot;</span><span class="token operator">:</span> <span class="token string">&quot;J. R. R. &lt;em&gt;T&lt;/em&gt;olkien&quot;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    ...
<span class="token punctuation">}</span>
</code></pre></div><p>-&gt; <code>id</code>, <code>title</code> and <code>author</code> are returned in <code>_formatted</code> because<code>attributesToHighlight</code> is set to <code>[&quot;*&quot;]</code> (but also <code>attributesToRetrieve</code> by default).
-&gt; Both <code>title</code> and <code>author</code> are highlighted because <code>attributesToHighlight</code> is set to <code>[&quot;*&quot;]</code>.</p> <p>Example 3:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;q&quot;</span><span class="token operator">:</span> <span class="token string">&quot;t&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;attributesToRetrieve&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;author&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;attributesToHighlight&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;author&quot;</span><span class="token operator">:</span> <span class="token string">&quot;J. R. R. Tolkien&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;_formatted&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&lt;em&gt;T&lt;/em&gt;he Hobbit&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;author&quot;</span><span class="token operator">:</span> <span class="token string">&quot;J. R. R. Tolkien&quot;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    ...
<span class="token punctuation">}</span>
</code></pre></div><p>-&gt; Only <code>author</code> is returned at the root of the document because defined in the <code>attributesToRetrieve</code>.
-&gt; Only <code>author</code> and <code>title</code> are returned in <code>_formatted</code> because the addition of <code>attributesToRetrieve</code> and <code>attributesToHighlight</code>.
-&gt; Only <code>title</code> is highlighted because the only one defined in <code>attributesToHighlight</code>.</p> <p>Example 4:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;q&quot;</span><span class="token operator">:</span> <span class="token string">&quot;t&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;attributesToRetrieve&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;attributesToHighlight&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;*&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;_formatted&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&lt;em&gt;T&lt;/em&gt;he Hobbit&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;author&quot;</span><span class="token operator">:</span> <span class="token string">&quot;J. R. R. &lt;em&gt;T&lt;/em&gt;olkien&quot;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    ...
<span class="token punctuation">}</span>
</code></pre></div><p>-&gt; No attributes are returned at the root of the document because <code>attributesToRetrieve</code> is set to <code>[]</code>.
-&gt; All the attributes are returned in <code>_formatted</code> because <code>attributesToHighlight</code> is set to <code>[&quot;*&quot;]</code>.
-&gt; All the attributes are highlighted because <code>attributesToHighlight</code> is set to <code>[&quot;*&quot;]</code>.</p> <h6 id="_3-2-1-1-3-matchesposition"><a href="#_3-2-1-1-3-matchesposition" class="header-anchor">#</a> 3.2.1.1.3. <code>_matchesPosition</code></h6> <ul><li>Type: Object</li> <li>Required: False</li></ul> <p>Contains the location of each occurrence of queried terms across all fields. The <code>_matchesPosition</code> object is added to a search result when the <code>showMatchesPosition</code> search parameter is specified to true.</p> <p>The beginning of a matching term within a field is indicated by <code>start</code>, and its <code>length</code> by length.</p> <p><code>start</code> and <code>length</code> are measured in bytes and not the number of characters. For example, <code>ü</code> represents two bytes but one character.</p> <blockquote><p>See <a href="#3114-showmatchesposition">3.1.14. <code>showMatchesPosition</code></a> section.</p></blockquote> <h4 id="_3-2-2-limit"><a href="#_3-2-2-limit" class="header-anchor">#</a> 3.2.2. <code>limit</code></h4> <ul><li>Type: Integer</li> <li>Required: True</li></ul> <p>Returns the <code>limit</code> search parameter used for the query.</p> <blockquote><p>See <a href="#315-limit">3.1.5. <code>limit</code></a> section.</p></blockquote> <h4 id="_3-2-3-offset"><a href="#_3-2-3-offset" class="header-anchor">#</a> 3.2.3. <code>offset</code></h4> <ul><li>Type: Integer</li> <li>Required: True</li></ul> <p>Returns the <code>offset</code> search parameter used for the query.</p> <blockquote><p>See <a href="#316-offset">3.1.6. <code>offset</code> section</a> section.</p></blockquote> <h4 id="_3-2-4-estimatedtotalhits"><a href="#_3-2-4-estimatedtotalhits" class="header-anchor">#</a> 3.2.4. <code>estimatedTotalHits</code></h4> <ul><li>Type: Integer</li> <li>Required: True</li></ul> <p>Returns the estimated number of candidates for the search query.</p> <h4 id="_3-2-5-facetdistribution"><a href="#_3-2-5-facetdistribution" class="header-anchor">#</a> 3.2.5. <code>facetDistribution</code></h4> <ul><li>Type: Object</li> <li>Required: False</li></ul> <p>Added to the search response when <code>facets</code> is set for a search query. It contains the number of remaining candidates for each specified facet in the <code>facets</code> search parameter.</p> <p>If a field distributed as a facet contains no value, it is returned as a <code>facetDistribution</code> field with an empty object as value.</p> <blockquote><p>See <a href="#314-facets">3.1.4. <code>facet</code></a> section.</p></blockquote> <h4 id="_3-2-6-processingtimems"><a href="#_3-2-6-processingtimems" class="header-anchor">#</a> 3.2.6. <code>processingTimeMs</code></h4> <ul><li>Type: Integer</li> <li>Required: True</li></ul> <p>Processing time of the search query in <strong>milliseconds</strong>.</p> <h4 id="_3-2-7-query"><a href="#_3-2-7-query" class="header-anchor">#</a> 3.2.7. <code>query</code></h4> <ul><li>Type: String</li> <li>Required: True</li> <li>Default: <code>&quot;&quot;</code></li></ul> <p>Query originating the response. Equals to the <code>q</code> search parameter.</p> <blockquote><p>See <a href="#311-q">3.1.1. <code>q</code></a> section.</p></blockquote> <h2 id="_2-technical-details"><a href="#_2-technical-details" class="header-anchor">#</a> 2. Technical Details</h2> <p>n/a</p> <h2 id="_3-future-possibilities"><a href="#_3-future-possibilities" class="header-anchor">#</a> 3. Future Possibilities</h2> <ul><li>Add dedicated errors to replace <code>bad_request</code> error.</li></ul> <h3 id="_3-1-formatting-search-results"><a href="#_3-1-formatting-search-results" class="header-anchor">#</a> 3.1. Formatting Search Results</h3> <ul><li>Replaces <code>_matchesPosition</code> with chars position instead of bytes. It could also be a <code>mode</code> to choose <code>byte</code> or <code>char</code>.</li> <li>Move <code>attributesToHighlight</code>, <code>highlightPreTag</code>, <code>highlightPostTag</code>, <code>attributesToCrop</code>, <code>cropLength</code> and <code>cropMarker</code> into a <code>formatter</code> objet.</li> <li>Add an option to only highlight complete query term.</li> <li>Expose the <code>formatter</code> resource as an index setting.</li> <li>Highlight a phrase search as a single highlighted section.</li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/specifications/text/0117-typo-tolerance-setting-api.html" class="prev">
        Typo tolerance setting api
      </a></span> <span class="next"><a href="/specifications/text/0119-instance-options.html">
        Instance options
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.a3343b22.js" defer></script><script src="/assets/js/3.7860be15.js" defer></script><script src="/assets/js/35.543c03a1.js" defer></script>
  </body>
</html>
