<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Welcome to the Meilisearch dev specifications!</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.b26ff90a.css" as="style"><link rel="preload" href="/assets/js/app.715a2d53.js" as="script"><link rel="preload" href="/assets/js/3.7860be15.js" as="script"><link rel="preload" href="/assets/js/32.e18b0f3d.js" as="script"><link rel="prefetch" href="/assets/js/10.867f19e5.js"><link rel="prefetch" href="/assets/js/11.5950006a.js"><link rel="prefetch" href="/assets/js/12.3fc27b6c.js"><link rel="prefetch" href="/assets/js/13.569b541d.js"><link rel="prefetch" href="/assets/js/14.12e69b5e.js"><link rel="prefetch" href="/assets/js/15.d80f77d0.js"><link rel="prefetch" href="/assets/js/16.055f279b.js"><link rel="prefetch" href="/assets/js/17.13c224fe.js"><link rel="prefetch" href="/assets/js/18.f87d82ff.js"><link rel="prefetch" href="/assets/js/19.1374b4fc.js"><link rel="prefetch" href="/assets/js/20.aa0f50b5.js"><link rel="prefetch" href="/assets/js/21.d9d2de27.js"><link rel="prefetch" href="/assets/js/22.651633e9.js"><link rel="prefetch" href="/assets/js/23.b1da491b.js"><link rel="prefetch" href="/assets/js/24.0eb99e5a.js"><link rel="prefetch" href="/assets/js/25.a9ece5c8.js"><link rel="prefetch" href="/assets/js/26.33f21d3d.js"><link rel="prefetch" href="/assets/js/27.f2a6eeb7.js"><link rel="prefetch" href="/assets/js/28.943b40ae.js"><link rel="prefetch" href="/assets/js/29.b3e0eb9c.js"><link rel="prefetch" href="/assets/js/30.6aed4db2.js"><link rel="prefetch" href="/assets/js/31.0fa42e2c.js"><link rel="prefetch" href="/assets/js/33.a5caa74d.js"><link rel="prefetch" href="/assets/js/34.e68c4458.js"><link rel="prefetch" href="/assets/js/35.73b92b77.js"><link rel="prefetch" href="/assets/js/36.94cccae4.js"><link rel="prefetch" href="/assets/js/37.87daaeae.js"><link rel="prefetch" href="/assets/js/38.47a33431.js"><link rel="prefetch" href="/assets/js/39.017a6062.js"><link rel="prefetch" href="/assets/js/4.00ff60b8.js"><link rel="prefetch" href="/assets/js/40.a7044b1c.js"><link rel="prefetch" href="/assets/js/41.bfe574d2.js"><link rel="prefetch" href="/assets/js/42.534278aa.js"><link rel="prefetch" href="/assets/js/43.672c5a43.js"><link rel="prefetch" href="/assets/js/44.1be5b8c4.js"><link rel="prefetch" href="/assets/js/45.83835c91.js"><link rel="prefetch" href="/assets/js/46.0a56b5d8.js"><link rel="prefetch" href="/assets/js/47.7b51c9d1.js"><link rel="prefetch" href="/assets/js/48.0a681b8c.js"><link rel="prefetch" href="/assets/js/49.c3c4d010.js"><link rel="prefetch" href="/assets/js/5.06848b4d.js"><link rel="prefetch" href="/assets/js/6.87f02c74.js"><link rel="prefetch" href="/assets/js/7.fadbe260.js"><link rel="prefetch" href="/assets/js/8.d45b99a8.js"><link rel="prefetch" href="/assets/js/9.0c014273.js"><link rel="prefetch" href="/assets/js/vendors~docs-searchbar.9a2822a3.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b26ff90a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Welcome to the Meilisearch dev specifications!</span></a> <div class="links"><form id="search-form" role="search" class="meilisearch-search-wrapper search-box"><input id="meilisearch-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/specifications/text/specifications/text/0000-specification-template.html" class="nav-link">
  Specification
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/specifications/text/specifications/text/0000-specification-template.html" class="nav-link">
  Specification
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/specifications/text/0000-specification-template.html" class="sidebar-link">Specification template</a></li><li><a href="/specifications/text/0001-frontend-disable-prod.html" class="sidebar-link">Frontend disable prod</a></li><li><a href="/specifications/text/0001-script-based-tokenizer.html" class="sidebar-link">Script based tokenizer</a></li><li><a href="/specifications/text/0027-filter-and-facet-behavior.html" class="sidebar-link">Filter and facet behavior</a></li><li><a href="/specifications/text/0028-indexing-csv.html" class="sidebar-link">Indexing csv</a></li><li><a href="/specifications/text/0029-indexing-ndjson.html" class="sidebar-link">Indexing ndjson</a></li><li><a href="/specifications/text/0030-asc-desc-criterion.html" class="sidebar-link">Asc desc criterion</a></li><li><a href="/specifications/text/0032-distinct-attribute.html" class="sidebar-link">Distinct attribute</a></li><li><a href="/specifications/text/0033-logging.html" class="sidebar-link">Logging</a></li><li><a href="/specifications/text/0034-telemetry-policies.html" class="sidebar-link">Telemetry policies</a></li><li><a href="/specifications/text/0036-exactness-criterion.html" class="sidebar-link">Exactness criterion</a></li><li><a href="/specifications/text/0038-rename-attributes-for-faceting.html" class="sidebar-link">Rename attributes for faceting</a></li><li><a href="/specifications/text/0039-_formatted-field-behavior.html" class="sidebar-link">_formatted field behavior</a></li><li><a href="/specifications/text/0043-phrase-query.html" class="sidebar-link">Phrase query</a></li><li><a href="/specifications/text/0047-reset-stop-words-synonyms-settings-with-null.html" class="sidebar-link">Reset stop words synonyms settings with null</a></li><li><a href="/specifications/text/0048-rename-max-mdb-size-var.html" class="sidebar-link">Rename max mdb size var</a></li><li><a href="/specifications/text/0055-sort.html" class="sidebar-link">Sort</a></li><li><a href="/specifications/text/0059-geo-search.html" class="sidebar-link">Geo search</a></li><li><a href="/specifications/text/0060-tasks-api.html" class="sidebar-link">Tasks api</a></li><li><a href="/specifications/text/0061-error-format-and-definitions.html" class="sidebar-link">Error format and definitions</a></li><li><a href="/specifications/text/0077-words-position-limit.html" class="sidebar-link">Words position limit</a></li><li><a href="/specifications/text/0085-api-keys.html" aria-current="page" class="active sidebar-link">Api keys</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/specifications/text/0085-api-keys.html#_1-functional-specification" class="sidebar-link">1. Functional Specification</a></li><li class="sidebar-sub-header"><a href="/specifications/text/0085-api-keys.html#_2-technical-aspects" class="sidebar-link">2. Technical Aspects</a></li><li class="sidebar-sub-header"><a href="/specifications/text/0085-api-keys.html#_3-future-possibilities" class="sidebar-link">3. Future Possibilities</a></li></ul></li><li><a href="/specifications/text/0089-tenant-tokens.html" class="sidebar-link">Tenant tokens</a></li><li><a href="/specifications/text/0096-auto-batching.html" class="sidebar-link">Auto batching</a></li><li><a href="/specifications/text/0105-dumps-api.html" class="sidebar-link">Dumps api</a></li><li><a href="/specifications/text/0118-search-api.html" class="sidebar-link">Search api</a></li><li><a href="/specifications/text/0119-instance-options.html" class="sidebar-link">Instance options</a></li><li><a href="/specifications/text/0123-displayed-attributes-setting-api.html" class="sidebar-link">Displayed attributes setting api</a></li><li><a href="/specifications/text/0123-distinct-attribute-setting-api.html" class="sidebar-link">Distinct attribute setting api</a></li><li><a href="/specifications/text/0123-filterable-attributes-setting-api.html" class="sidebar-link">Filterable attributes setting api</a></li><li><a href="/specifications/text/0123-ranking-rules-setting-api.html" class="sidebar-link">Ranking rules setting api</a></li><li><a href="/specifications/text/0123-searchable-attributes-setting-api.html" class="sidebar-link">Searchable attributes setting api</a></li><li><a href="/specifications/text/0123-settings-api.html" class="sidebar-link">Settings api</a></li><li><a href="/specifications/text/0123-sortable-attributes-setting-api.html" class="sidebar-link">Sortable attributes setting api</a></li><li><a href="/specifications/text/0123-stop-words-setting-api.html" class="sidebar-link">Stop words setting api</a></li><li><a href="/specifications/text/0123-synonyms-setting-api.html" class="sidebar-link">Synonyms setting api</a></li><li><a href="/specifications/text/0124-documents-api.html" class="sidebar-link">Documents api</a></li><li><a href="/specifications/text/0132-indexes-api.html" class="sidebar-link">Indexes api</a></li><li><a href="/specifications/text/0134-stats-api.html" class="sidebar-link">Stats api</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><ul><li>Title: API Keys</li> <li>Start Date: 2021-10-15</li> <li>Specification PR: <a href="https://github.com/meilisearch/specifications/pull/85" target="_blank" rel="noopener noreferrer">#85<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>Discovery Issue: <a href="https://github.com/meilisearch/product/issues/51" target="_blank" rel="noopener noreferrer">#51<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h1 id="api-keys"><a href="#api-keys" class="header-anchor">#</a> API Keys</h1> <h2 id="_1-functional-specification"><a href="#_1-functional-specification" class="header-anchor">#</a> 1. Functional Specification</h2> <h3 id="_1-1-summary"><a href="#_1-1-summary" class="header-anchor">#</a> 1.1 Summary</h3> <p>Granular management of API keys is added to MeiliSearch. It is possible to restrict the access of an API key to certain actions on specific indexes.</p> <h3 id="_1-2-motivation"><a href="#_1-2-motivation" class="header-anchor">#</a> 1.2 Motivation</h3> <p>To make MeiliSearch more reliable for teams, we extend the management and the possibilities of restrictions for the management of a MeiliSearch instance by introducing a concrete API resource (<code>API Key</code>). Security is a critical need, often tricky to negotiate as the stakes are high for a company.</p> <h3 id="_1-3-glossary"><a href="#_1-3-glossary" class="header-anchor">#</a> 1.3 Glossary</h3> <table><thead><tr><th>Term</th> <th>Definition</th></tr></thead> <tbody><tr><td>Master Key</td> <td>This is the master key that allows you to create other API keys. The master key is defined by the user when launching MeiliSearch, thus gives access to the <code>/keys</code> API endpoint.</td></tr> <tr><td>API Key</td> <td>API keys are stored and managed from the endpoint <code>/keys</code> by the master key holder. These are the keys used by the technical teams to interact with MeiliSearch at the level of the client code.</td></tr></tbody></table> <h3 id="_1-4-personas"><a href="#_1-4-personas" class="header-anchor">#</a> 1.4 Personas</h3> <table><thead><tr><th>Persona</th> <th>Role</th></tr></thead> <tbody><tr><td>Anna</td> <td>Anna has an <code>ssh</code> access to the MeiliSearch instance and manages it on a daily basis.</td></tr> <tr><td>Mark</td> <td>Mark is a developer from the same company as Anna. He will implement the code to communicate with MeiliSearch to solve technical/product needs.</td></tr></tbody></table> <h3 id="_1-5-api-key-explanations"><a href="#_1-5-api-key-explanations" class="header-anchor">#</a> 1.5 <code>API Key</code> Explanations</h3> <h4 id="_1-5-1-summary-key-points"><a href="#_1-5-1-summary-key-points" class="header-anchor">#</a> 1.5.1 Summary Key Points</h4> <ul><li><code>X-MEILI-API-KEY</code> header is replaced by the <code>Authorization</code> header. <code>API keys</code> must be specified with the bearer authorization method. See examples.</li> <li><code>/keys</code> management is restricted to the master key.</li> <li>When a master key is set at MeiliSearch first-launch, we generate two pre-configured default <code>API Key</code> resources. A <code>Default Search API Key</code> restricted to the search action and a <code>Default Admin API Key</code> to handle all operations (except managing <code>/keys</code> resource) on MeiliSearch.</li> <li>If the master-key changes, all <code>API Keys</code> are re-generated.</li> <li>These default API Keys can be modified/deleted with the <code>/keys</code> endpoint but are not re-created if MeiliSearch has already created them.</li> <li>New endpoints are added to manage the <code>API Key</code> resource.</li> <li><code>API keys</code> can have restrictions on which methods can be accessed via an <code>actions</code> list; they can also <code>expiresAt</code> a specific date time and be restricted to a specific set of <code>indexes</code>.</li> <li>There is no possibility to regenerate the value of the <code>key</code> field for a specific <code>API key</code> in this first iteration.</li> <li>New errors are added and the <code>missing_authorization_header</code> message is updated.</li> <li>The current state of the <code>API Keys</code> resource is propagated to snapshots and dumps.</li></ul> <h4 id="_1-5-2-master-key"><a href="#_1-5-2-master-key" class="header-anchor">#</a> 1.5.2 Master Key</h4> <p>The master key exists to secure a MeiliSearch instance. As soon as a master key is set via the  <code>MEILI_MASTER_KEY</code> environment variable or the <code>--master-key</code> CLI option , the endpoint <code>/keys</code> is accessible only for the master key holder. It can be seen as a super admin key; It must be shared only with people who have to manage the security of a MeiliSearch instance.</p> <p>This master key is not an API Key, thus is not stored and fetchable from the <code>/keys</code> API endpoint. It must be seen as a runtime lock that activates the security of MeiliSearch as soon as an instance is launched with it.</p> <p>At the first launch of MeiliSearch with a master key, MeiliSearch automatically generates two default API keys (See the <code>GET - /keys</code> example) to cover many of the most basic needs. It generates a <code>Default Search API Key</code> dedicated to the search that can be used on the client-side and a <code>Default Admin API Key</code> to manipulate a MeiliSearch instance from a backend side.</p> <p>If the master key is removed at MeiliSearch launch, the previously generated API keys no longer secure the MeiliSearch instance.</p> <p>If MeiliSearch is launched with the <code>production</code> value for the <code>MEILI_ENV</code> environment variable or the <code>--env</code> CLI option, a master key is mandatory to force the user to secure his instance. If the master key is omitted in that particular case, MeiliSearch launch is aborted and displays the <code>Error: In production mode, the environment variable MEILI_MASTER_KEY is mandatory</code> error in stdout.</p> <p>The master key must be composed of valid utf-8 characters. It is advisable to enclose it in <code>'</code> when specified via the --master-key option.</p> <blockquote><p>🚨 A user coming from a version prior to v0.25.0 and having a master-key will have to update their code to use the newly generated default keys replacing the public and private, since we changed the previous <code>public</code> and <code>private</code> API Key generation, is it mandatory for that specific version upgrade. Now, a prefix of an API Key is generated uniquely and the final value of the <code>key</code> field is a hash of that randomized prefix with the master-key. See 2.1 API Key Generation part.</p></blockquote> <blockquote><p>🚨 The master-key should never be exposed to the public or bad-intentioned persons for security measures as it may compromise a MeiliSearch instance.</p></blockquote> <blockquote><p>🚨 If the value of the master key changes, all the previously generated <code>API Keys</code> changes, thus allows to invalidate the set of keys previously generated by regenerating to a different value for the <code>key</code> field. This is particularly useful in the case where the master key might have been leaked and the user need to re-generate the whole set of keys at once to re-secure the instance.</p></blockquote> <blockquote><p>Note that the master key does not appear on the <code>/keys</code> endpoints.</p></blockquote> <h4 id="_1-5-3-default-api-keys"><a href="#_1-5-3-default-api-keys" class="header-anchor">#</a> 1.5.3 Default API Keys</h4> <p>When the user accessing the machine launches MeiliSearch with a <code>master</code> key the first time, MeiliSearch will generate two API keys described below, as it did before with the <code>public</code> and <code>private</code> key.</p> <p>If the user changes the value of the <code>master</code> key later, these two default keys are not created again but re-generated with a different <code>key</code> field. However, these two API keys can be changed using the <code>/keys</code> endpoints.</p> <p>MeiliSearch must know that it has already generated these Default API Keys internally so if the user delete them, the engine should not create them again when MeiliSearch is launched again with a <code>master</code> key.</p> <h5 id="_1-5-3-1-default-search-api-key"><a href="#_1-5-3-1-default-search-api-key" class="header-anchor">#</a> 1.5.3.1 Default Search API Key</h5> <p>The <code>Default Search API key</code> gives access to the same rights as the old <code>public</code> key.</p> <p>Here is how the <code>Default Search API Key</code> is represented after its generation.</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Default Search API Key (Use it to search from the frontend)&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0a6e572506c52ab0bd6195921575d23092b7f0c284ab4ac86d12346c33057f99&quot;</span><span class="token punctuation">,</span> <span class="token comment">//example</span>
    <span class="token property">&quot;actions&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;search&quot;</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;indexes&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;*&quot;</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;expiresAt&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
    <span class="token property">&quot;createdAt&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2021-08-11T10:00:00Z&quot;</span><span class="token punctuation">,</span> <span class="token comment">//example</span>
    <span class="token property">&quot;updatedAt&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2021-08-11T10:00:00Z&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><h5 id="_1-5-3-2-default-admin-api-key"><a href="#_1-5-3-2-default-admin-api-key" class="header-anchor">#</a> 1.5.3.2 Default Admin API Key</h5> <p>The <code>Default Admin API key</code> gives access to the same rights as the old <code>private</code> key.</p> <p>Here is how the <code>Default Admin API Key</code> is represented after its generation.</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Default Admin API Key (Use it for all other operations. Caution! Do not use it on a public frontend)&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;380689dd379232519a54d15935750cc7625620a2ea2fc06907cb40ba5b421b6f&quot;</span><span class="token punctuation">,</span> <span class="token comment">//example</span>
    <span class="token property">&quot;actions&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;*&quot;</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;indexes&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;*&quot;</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;expiresAt&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
    <span class="token property">&quot;createdAt&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2021-08-11T10:00:00Z&quot;</span><span class="token punctuation">,</span> <span class="token comment">//example</span>
    <span class="token property">&quot;updatedAt&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2021-08-11T10:00:00Z&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_1-5-3-managing-api-key"><a href="#_1-5-3-managing-api-key" class="header-anchor">#</a> 1.5.3 Managing <code>API Key</code></h4> <p><img src="https://i.imgur.com/mAUFnNb.png" alt=""></p> <p><code>Anna</code> manages the MeiliSearch instance; she uses the master key she defined at startup to generate an <code>API Key</code> resource for <code>Mark</code> to use in his client code to communicate with the MeiliSearch instance.</p> <p><code>Anna</code> can define access rights to certain indexes to define an expiration date and also authorized <code>actions</code> for an <code>API Key</code> (See API Key Actions List Definition Part).</p> <p>Only the master key allows managing the API keys.</p> <h4 id="_1-5-4-api-key-object-representation"><a href="#_1-5-4-api-key-object-representation" class="header-anchor">#</a> 1.5.4 <code>API Key</code> object representation</h4> <table><thead><tr><th>field</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td>description</td> <td>string</td> <td>A description for the key. <code>null</code> if empty.</td></tr> <tr><td>key</td> <td>string</td> <td>The generated key. <strong>Generated by MeiliSearch</strong>.</td></tr> <tr><td>actions</td> <td>array</td> <td>A list of actions permitted for the key. <code>[&quot;*&quot;]</code> for all actions. See Actions list definition part.</td></tr> <tr><td>indexes</td> <td>array</td> <td>A list of indexes permitted for the key. <code>[&quot;*&quot;]</code> for all indexes.</td></tr> <tr><td>expiresAt</td> <td>string</td> <td>Represent the expiration date and time as <code>RFC 3339</code> format. <code>null</code> equals to no expiration time.</td></tr> <tr><td>createdAt</td> <td>string</td> <td>Represent the date and time as <code>RFC 3339</code> format when the API key has been created. <strong>Generated by MeiliSearch</strong></td></tr> <tr><td>updatedAt</td> <td>string</td> <td>Represent the date and time as <code>RFC 3339</code> format when the API key has been updated. <strong>Default</strong>: Value of <code>createdAt</code>. <strong>Generated by MeiliSearch</strong></td></tr></tbody></table> <h4 id="_1-5-5-post-patch-keys-api-key-object-payload-definition"><a href="#_1-5-5-post-patch-keys-api-key-object-payload-definition" class="header-anchor">#</a> 1.5.5 <code>POST</code>/ <code>PATCH</code> - <code>/keys</code> - API Key object payload definition</h4> <table><thead><tr><th>field</th> <th>type</th> <th>required</th> <th>description</th></tr></thead> <tbody><tr><td>indexes</td> <td>array</td> <td>Required</td> <td><code>[*]</code> for all indexes. <strong>Default</strong>: <code>No Default</code></td></tr> <tr><td>description</td> <td>string</td> <td>Optional</td> <td>A description for the API key. <strong>Default</strong>: <code>null</code></td></tr> <tr><td>actions</td> <td>array</td> <td>Required</td> <td>A list of actions permitted for the API key. <code>[&quot;*&quot;]</code> for all actions. <strong>See Actions list definition part</strong>. <code>*</code> character can be used as a wildcard. e.g. <code>documents.*</code> to authorize access on all documents endpoints. <strong>Default</strong>: <code>No default</code></td></tr> <tr><td>expiresAt</td> <td>string</td> <td>Required</td> <td>The expiration date and time as <code>RFC 3339</code> format. <code>null</code> equals to no expiration time. Sending only the date part e.g <code>2021-12-01</code> leads to having an <code>expiresAt</code> value set to <code>2021-12-01T00:00:00</code>. <strong>Default</strong>: <code>No Default</code></td></tr></tbody></table> <h4 id="_1-5-6-actions-list-definition"><a href="#_1-5-6-actions-list-definition" class="header-anchor">#</a> 1.5.6 Actions List Definition</h4> <blockquote><p><code>:authorizedIndexes</code> can be any value extracted from the <code>indexes</code> field of an <code>API key</code> resource.</p></blockquote> <table><thead><tr><th>name</th> <th>description</th></tr></thead> <tbody><tr><td>search</td> <td>Provides access to <code>GET</code> and <code>POST</code> methods on <code>/indexes/:authorizedIndexes/search</code> routes.</td></tr> <tr><td>documents.add</td> <td>Provides access to <code>POST</code> and <code>PUT</code> on <code>/indexes/:authorizedIndexes/documents</code> routes.</td></tr> <tr><td>documents.get</td> <td>Provides access to <code>GET</code> methods on <code>/indexes/:authorizedIndexes/documents</code> and <code>/indexes/:authorizedIndexes/documents/:documentId</code> routes.</td></tr> <tr><td>documents.delete</td> <td>Provides access to <code>DELETE</code> method on <code>/indexes/:authorizedIndexes/documents/:documentId</code>, <code>indexes/:authorizedIndexes/documents/:documentId</code> and <code>POST</code> method on <code>/indexes/:authorizedIndexes/documents/delete-batch</code> routes.</td></tr> <tr><td>indexes.create</td> <td>Provides access to <code>POST</code> <code>/indexes</code>. <strong>⚠️ <code>indexes</code> field should indicate the newly created index or having <code>[*]</code> to permits access on it.</strong>.</td></tr> <tr><td>indexes.get</td> <td>Provides access to <code>GET</code> <code>/indexes</code> and <code>/indexes/:authorizedIndexes</code>. <strong>⚠️Non-authorized <code>indexes</code> are omitted from the response on <code>/indexes</code></strong>.</td></tr> <tr><td>indexes.update</td> <td>Provides access to <code>PUT</code> <code>/indexes/:authorizedIndexes</code>.</td></tr> <tr><td>indexes.delete</td> <td>Provides access to <code>DELETE</code> <code>/indexes/:authorizedIndexes</code>.</td></tr> <tr><td>tasks.get</td> <td>Provides access to <code>GET</code> <code>/tasks</code>. <strong>⚠️Non-authorized <code>indexes</code> are omitted from the response on <code>/tasks</code></strong>. Also add access to <code>GET</code> <code>/indexes/:authorizedIndexes/tasks</code> routes.</td></tr> <tr><td>settings.get</td> <td>Provides access to <code>GET</code> <code>/indexes/:authorizedIndexes/settings</code> and <code>/indexes/:authorizedIndexes/settings/*</code> routes.</td></tr> <tr><td>settings.update</td> <td>Provides access to <code>POST / DELETE</code> <code>/indexes/:authorizedIndexes/settings</code> and <code>/indexes/:authorizedIndexes/settings/*</code> routes.</td></tr> <tr><td>stats.get</td> <td>Provides access to <code>GET</code> <code>/stats/</code>. <strong>⚠️Non-authorized <code>indexes</code> are omitted from the response on <code>/stats</code></strong>. Also add access to <code>GET</code> <code>/indexes/:authorizedIndexes/stats</code>.</td></tr> <tr><td>dumps.create</td> <td>Provides access to <code>POST</code> <code>/dumps</code> route. <strong>As dumps are not scoped by indexes, a restriction on <code>indexes</code> does not affect this action.</strong></td></tr> <tr><td>dumps.get</td> <td>Provides access to <code>GET</code> <code>/dumps/:dumpUid</code> route. <strong>As dumps are not scoped by indexes, a restriction on <code>indexes</code> does not affect this action.</strong></td></tr> <tr><td>version</td> <td>Provides access to <code>GET</code> <code>/version</code> route.</td></tr></tbody></table> <hr> <h4 id="as-anna-👩-i-want-to-create-an-api-key-for-mark-👨🏻-client-code-so-that-he-can-index-some-documents-into-meilisearch"><a href="#as-anna-👩-i-want-to-create-an-api-key-for-mark-👨🏻-client-code-so-that-he-can-index-some-documents-into-meilisearch" class="header-anchor">#</a> <strong>As <code>Anna 👩</code>, I want to create an <code>API key</code> for <code>Mark 👨🏻</code> client-code, so that he can index some documents into MeiliSearch</strong></h4> <h5 id="request-definition"><a href="#request-definition" class="header-anchor">#</a> Request Definition</h5> <p><code>POST</code> - <code>/keys</code></p> <h5 id="headers"><a href="#headers" class="header-anchor">#</a> Headers</h5> <div class="language- extra-class"><pre class="language-text"><code>&quot;Authorization: Bearer :masterKey&quot;
&quot;Content-Type: application/json&quot;
</code></pre></div><h5 id="body-payload"><a href="#body-payload" class="header-anchor">#</a> Body Payload</h5> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Indexing Products API key&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;actions&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;documents.add&quot;</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;indexes&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;products&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;expiresAt&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2021-11-13T00:00:00Z&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><h5 id="response"><a href="#response" class="header-anchor">#</a> Response</h5> <p><code>201 Created</code></p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Indexing Products API key&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;d0552b41536279a0ad88bd595327b96f01176a60c2243e906c52ac02375f9bc4&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;actions&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;documents.add&quot;</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;indexes&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;products&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;expiresAt&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2021-11-13T00:00:00Z&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;createdAt&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2021-11-12T10:00:00Z&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;updatedAt&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2021-11-12T10:00:00Z&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><h5 id="requirements"><a href="#requirements" class="header-anchor">#</a> Requirements</h5> <ul><li><code>actions</code> is mandatory and should be an array of valid <code>actions</code>.</li> <li><code>indexes</code> is mandatory and should be an array of string.</li> <li><code>expiresAt</code> is mandatory and must be a valid <code>RFC 3339</code> datetime in the future or <code>null</code>.</li> <li>If set, <code>description</code> should be a string or <code>null</code>.</li></ul> <h5 id="errors"><a href="#errors" class="header-anchor">#</a> Errors</h5> <ul><li>🔴 Accessing this route without the <code>Authorization</code> header returns a <a href="/specifications/text/0061-error-format-and-definitions.html#missing_authorization_header">missing_authorization_header</a> error.</li> <li>🔴 Accessing this route with a key that does not have permissions (i.e. other than the master-key) returns an <a href="/specifications/text/0061-error-format-and-definitions.html#invalid_api_key">invalid_api_key</a> error.</li> <li>🔴 Omitting Content-Type header returns a <a href="/specifications/text/0061-error-format-and-definitions.html#missing_content_type">missing_content_type</a> error.</li> <li>🔴 Sending an empty Content-Type returns an <a href="/specifications/text/0061-error-format-and-definitions.html#invalid_content_type">invalid_content_type</a> error.</li> <li>🔴 Sending a different Content-Type than <code>application/json</code> returns an <a href="/specifications/text/0061-error-format-and-definitions.html#invalid_content_type">invalid_content_type</a> error.</li> <li>🔴 Sending an empty payload returns a <a href="/specifications/text/0061-error-format-and-definitions.html#missing_payload">missing_payload</a> error.</li> <li>🔴 Sending a different payload type than the Content-Type header returns a <a href="/specifications/text/0061-error-format-and-definitions.html#malformed_payload">malformed_payload</a> error.</li> <li>🔴 Sending an invalid json format returns a <a href="/specifications/text/0061-error-format-and-definitions.html#malformed_payload">malformed_payload</a> error.</li> <li>🔴 Omitting <code>actions</code> field from the payload returns a <a href="/specifications/text/0061-error-format-and-definitions.html#missing_parameter">missing_parameter</a> error.</li> <li>🔴 Omitting <code>indexes</code> field from the payload returns a <a href="/specifications/text/0061-error-format-and-definitions.html#missing_parameter">missing_parameter</a> error.</li> <li>🔴 Omitting <code>expiresAt</code> field from the payload returns a <a href="/specifications/text/0061-error-format-and-definitions.html#missing_parameter">missing_parameter</a> error.</li> <li>🔴 Sending an invalid value for the <code>actions</code> field returns an <a href="/specifications/text/0061-error-format-and-definitions.html#invalid_api_key_actions">invalid_api_key_actions</a> error.</li> <li>🔴 Sending an invalid value for the <code>indexes</code> field returns an <a href="/specifications/text/0061-error-format-and-definitions.html#invalid_api_key_indexes">invalid_api_key_indexes</a> error.</li> <li>🔴 Sending an invalid value for the <code>expiresAt</code> field returns an <a href="/specifications/text/0061-error-format-and-definitions.html#invalid_api_key_expires_at">invalid_api_key_expires_at</a> error.</li> <li>🔴 Sending an invalid value for the <code>description</code> field returns an <a href="/specifications/text/0061-error-format-and-definitions.html#invalid_api_key_description">invalid_api_key_description</a> error.</li></ul> <hr> <h4 id="as-anna-👩-i-want-to-get-details-about-an-api-key"><a href="#as-anna-👩-i-want-to-get-details-about-an-api-key" class="header-anchor">#</a> <strong>As <code>Anna 👩</code>, I want to get details about an <code>API Key</code></strong></h4> <h5 id="request-definition-2"><a href="#request-definition-2" class="header-anchor">#</a> Request Definition</h5> <p><code>GET</code> - <code>/keys/:key</code></p> <h5 id="headers-2"><a href="#headers-2" class="header-anchor">#</a> Headers</h5> <div class="language- extra-class"><pre class="language-text"><code>&quot;Authorization: Bearer :masterKey&quot;
</code></pre></div><h5 id="response-2"><a href="#response-2" class="header-anchor">#</a> Response</h5> <p><code>200 Success</code></p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Indexing API key&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;d0552b41536279a0ad88bd595327b96f01176a60c2243e906c52ac02375f9bc4&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;actions&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;documents.add&quot;</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;indexes&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;products&quot;</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;expiresAt&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2021-11-13T00:00:00Z&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;createdAt&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2021-11-12T10:00:00Z&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;updatedAt&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2021-11-12T10:00:00Z&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><h5 id="errors-2"><a href="#errors-2" class="header-anchor">#</a> Errors</h5> <ul><li>🔴 Accessing this route without the <code>Authorization</code> header returns a <a href="/specifications/text/0061-error-format-and-definitions.html#missing_authorization_header">missing_authorization_header</a> error.</li> <li>🔴 Accessing this route with a key that does not have permissions (i.e. other than the master-key) returns an <a href="/specifications/text/0061-error-format-and-definitions.html#invalid_api_key">invalid_api_key</a> error.</li> <li>🔴 Attempting to access an API key that does not exist returns an <a href="/specifications/text/0061-error-format-and-definitions.html#api_key_not_found">api_key_not_found</a> error.</li></ul> <hr> <h4 id="as-anna-👩-i-want-to-update-api-key-to-change-its-restrictions"><a href="#as-anna-👩-i-want-to-update-api-key-to-change-its-restrictions" class="header-anchor">#</a> <strong>As <code>Anna 👩</code>, I want to update API key to change its restrictions</strong></h4> <h5 id="request-definition-3"><a href="#request-definition-3" class="header-anchor">#</a> Request Definition</h5> <p><code>PATCH</code> - <code>/keys/:key</code></p> <h5 id="headers-3"><a href="#headers-3" class="header-anchor">#</a> Headers</h5> <div class="language- extra-class"><pre class="language-text"><code>&quot;Authorization: Bearer :masterKey&quot;
&quot;Content-Type: application/json&quot;
</code></pre></div><h5 id="body-payload-2"><a href="#body-payload-2" class="header-anchor">#</a> Body Payload</h5> <blockquote><p>PATCH method allows making partial changes to an existing resource. Thus the user is not obliged to send the complete API resource for each update.</p></blockquote> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Manage Products/Reviews Documents API key&quot;</span><span class="token punctuation">,</span> <span class="token comment">//Update the description to specify the API Key purposes.</span>
    <span class="token property">&quot;actions&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;documents.add&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;documents.delete&quot;</span> <span class="token comment">//Has now access to documents deletion</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;indexes&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;products&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;reviews&quot;</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">//Has now access to reviews</span>
    <span class="token property">&quot;expiresAt&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2021-12-31T23:59:59Z&quot;</span> <span class="token comment">//Extended to the end of the year</span>
<span class="token punctuation">}</span>
</code></pre></div><h5 id="response-3"><a href="#response-3" class="header-anchor">#</a> Response</h5> <p><code>200 Success</code></p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Manage Products/Reviews Documents API key&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;d0552b41536279a0ad88bd595327b96f01176a60c2243e906c52ac02375f9bc4&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;actions&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;documents.add&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;documents.delete&quot;</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;indexes&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;products&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;reviews&quot;</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;expiresAt&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2021-12-31T23:59:59Z&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;createdAt&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2021-11-12T10:00:00Z&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;updatedAt&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2021-10-12T15:00:00Z&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><h5 id="errors-3"><a href="#errors-3" class="header-anchor">#</a> Errors</h5> <ul><li>🔴 Accessing this route without the <code>Authorization</code> header returns a <a href="/specifications/text/0061-error-format-and-definitions.html#missing_authorization_header">missing_authorization_header</a> error.</li> <li>🔴 Accessing this route with a key that does not have permissions (i.e. other than the master-key) returns an <a href="/specifications/text/0061-error-format-and-definitions.html#invalid_api_key">invalid_api_key</a> error.</li> <li>🔴 Attempting to access an API key that does not exist returns a <a href="/specifications/text/0061-error-format-and-definitions.html#api_key_not_found">api_key_not_found</a> error.</li> <li>🔴 Omitting Content-Type header returns a <a href="/specifications/text/0061-error-format-and-definitions.html#missing_content_type">missing_content_type</a> error.</li> <li>🔴 Sending an empty Content-Type returns an <a href="/specifications/text/0061-error-format-and-definitions.html#invalid_content_type">invalid_content_type</a> error.</li> <li>🔴 Sending a different Content-Type than <code>application/json</code> returns an <a href="/specifications/text/0061-error-format-and-definitions.html#invalid_content_type">invalid_content_type</a> error.</li> <li>🔴 Sending an empty payload returns a <a href="/specifications/text/0061-error-format-and-definitions.html#missing_payload">missing_payload</a> error.</li> <li>🔴 Sending a different payload type than the Content-Type header returns a <a href="/specifications/text/0061-error-format-and-definitions.html#malformed_payload">malformed_payload</a> error.</li> <li>🔴 Sending an invalid json format returns a <a href="/specifications/text/0061-error-format-and-definitions.html#malformed_payload">malformed_payload</a> error.</li> <li>🔴 Sending an invalid value for the <code>actions</code> field returns an <a href="/specifications/text/0061-error-format-and-definitions.html#invalid_api_key_actions">invalid_api_key_actions</a> error.</li> <li>🔴 Sending an invalid value for the <code>indexes</code> field returns an <a href="/specifications/text/0061-error-format-and-definitions.html#invalid_api_key_indexes">invalid_api_key_indexes</a> error.</li> <li>🔴 Sending an invalid value for the <code>expiresAt</code> field returns an <a href="/specifications/text/0061-error-format-and-definitions.html#invalid_api_key_expires_at">invalid_api_key_expires_at</a> error.</li> <li>🔴 Sending an invalid value for the <code>description</code> field returns an <a href="/specifications/text/0061-error-format-and-definitions.html#invalid_api_key_description">invalid_api_key_description</a> error.</li></ul> <hr> <h4 id="as-anna-👩-i-want-to-list-the-api-keys"><a href="#as-anna-👩-i-want-to-list-the-api-keys" class="header-anchor">#</a> <strong>As <code>Anna 👩</code>, I want to list the API Keys</strong></h4> <h5 id="request-definition-4"><a href="#request-definition-4" class="header-anchor">#</a> Request Definition</h5> <p><code>GET</code> - <code>/keys</code></p> <h5 id="headers-4"><a href="#headers-4" class="header-anchor">#</a> Headers</h5> <div class="language- extra-class"><pre class="language-text"><code>&quot;Authorization: Bearer :masterKey&quot;
</code></pre></div><h5 id="response-4"><a href="#response-4" class="header-anchor">#</a> Response</h5> <p><code>200 Success</code></p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;results&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Manage Products/Reviews Documents API key&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;d0552b41536279a0ad88bd595327b96f01176a60c2243e906c52ac02375f9bc4&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;actions&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">&quot;documents.add&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;documents.delete&quot;</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token property">&quot;indexes&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">&quot;products&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;reviews&quot;</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token property">&quot;expiresAt&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2021-12-31T23:59:59Z&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;createdAt&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2021-10-12T00:00:00Z&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;updatedAt&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2021-10-13T15:00:00Z&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Default Search API Key (Use it to search from the frontend code)&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0a6e572506c52ab0bd6195921575d23092b7f0c284ab4ac86d12346c33057f99&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;actions&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">&quot;search&quot;</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token property">&quot;indexes&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">&quot;*&quot;</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token property">&quot;expiresAt&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
            <span class="token property">&quot;createdAt&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2021-08-11T10:00:00Z&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;updatedAt&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2021-08-11T10:00:00Z&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Default Admin API Key (Use it for all other operations. Caution! Do not share it on the client side)&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;380689dd379232519a54d15935750cc7625620a2ea2fc06907cb40ba5b421b6f&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;actions&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">&quot;*&quot;</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token property">&quot;indexes&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">&quot;*&quot;</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token property">&quot;expiresAt&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
            <span class="token property">&quot;createdAt&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2021-08-11T10:00:00Z&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;updatedAt&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2021-08-11T10:00:00Z&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>Expired API keys can be found on the <code>/keys</code> endpoints. An archiving system or a filter could allow to not display them by default. See Future Possibilities part.</p></blockquote> <blockquote><p>👉 Note the two default generated API keys here. When a master key is set at MeiliSearch's launch, it generates two pre-configured <code>API Keys</code>. A Default Search API Key restricted to the search action on all indexes and a Default Admin API Key on all indexes to handle all operations (except managing API Keys).</p></blockquote> <h5 id="list-details"><a href="#list-details" class="header-anchor">#</a> List details</h5> <ul><li><code>API Key</code> objects are returned in a <code>results</code> array.</li> <li><code>API Keys</code> are ordered by <code>createdAt</code> in <code>desc</code> order. (Most recent first)</li> <li>No pagination yet. See Future Possibilities part.</li></ul> <h5 id="errors-4"><a href="#errors-4" class="header-anchor">#</a> Errors</h5> <ul><li>🔴 Accessing this route without the <code>Authorization</code> header returns a <a href="/specifications/text/0061-error-format-and-definitions.html#missing_authorization_header">missing_authorization_header</a> error.</li> <li>🔴 Accessing this route with a key that does not have permissions (i.e. other than the master-key) returns an <a href="/specifications/text/0061-error-format-and-definitions.html#invalid_api_key">invalid_api_key</a> error.</li></ul> <hr> <h4 id="as-anna-👩-i-want-to-delete-an-api-key"><a href="#as-anna-👩-i-want-to-delete-an-api-key" class="header-anchor">#</a> <strong>As <code>Anna 👩</code>, I want to delete an <code>API Key</code></strong></h4> <h5 id="request-definition-5"><a href="#request-definition-5" class="header-anchor">#</a> Request Definition</h5> <p><code>DELETE</code> - <code>/keys/:key</code></p> <h5 id="headers-5"><a href="#headers-5" class="header-anchor">#</a> Headers</h5> <div class="language- extra-class"><pre class="language-text"><code>&quot;Authorization: Bearer :masterKey&quot;
</code></pre></div><h5 id="response-5"><a href="#response-5" class="header-anchor">#</a> Response</h5> <p><code>204 No-Content</code></p> <h5 id="errors-5"><a href="#errors-5" class="header-anchor">#</a> Errors</h5> <ul><li>🔴 Accessing this route without the <code>Authorization</code> header returns a <a href="/specifications/text/0061-error-format-and-definitions.html#missing_authorization_header">missing_authorization_header</a> error.</li> <li>🔴 Accessing this route with a key that does not have permissions (i.e. other than the master-key) returns an <a href="/specifications/text/0061-error-format-and-definitions.html#invalid_api_key">invalid_api_key</a> error.</li> <li>🔴 Attempting to access an API key that does not exist returns a <code>api_key_not_found</code>.</li></ul> <hr> <h4 id="using-api-key-on-client-code"><a href="#using-api-key-on-client-code" class="header-anchor">#</a> Using <code>API Key</code> on client-code</h4> <p><img src="https://i.imgur.com/kRKcB43.png" alt=""></p> <p><code>Mark 👨🏻</code> receives the <code>API Key</code> transmitted by <code>Anna 👩</code> on a secured channel of their choice. He uses it to authenticate requests from the client code to MeiliSearch.</p> <h4 id="as-mark-👨🏻-i-am-using-an-expired-deleted-api-key"><a href="#as-mark-👨🏻-i-am-using-an-expired-deleted-api-key" class="header-anchor">#</a> <strong>As <code>Mark 👨🏻</code>, I am using an expired/deleted API Key</strong></h4> <h4 id="request-example"><a href="#request-example" class="header-anchor">#</a> Request example</h4> <p><code>POST</code> - <code>/indexes/movies/search</code></p> <h4 id="headers-6"><a href="#headers-6" class="header-anchor">#</a> Headers</h4> <div class="language- extra-class"><pre class="language-text"><code>    &quot;Authorization: Bearer :apiKey&quot;
    &quot;Content-Type: application/json&quot;
</code></pre></div><h4 id="response-6"><a href="#response-6" class="header-anchor">#</a> Response</h4> <ul><li>🔴 Accessing this route with an <code>API Key</code> that has expired or, been deleted returns an <a href="/specifications/text/0061-error-format-and-definitions.html#invalid_api_key">invalid_api_key</a> error.</li></ul> <hr> <h3 id="as-mark-👨🏻-i-am-using-a-valid-api-key-but-the-permission-set-is-not-sufficient-to-access-the-requested-api-resource"><a href="#as-mark-👨🏻-i-am-using-a-valid-api-key-but-the-permission-set-is-not-sufficient-to-access-the-requested-api-resource" class="header-anchor">#</a> <strong>As <code>Mark 👨🏻</code>, I am using a valid API Key, but the permission set is not sufficient to access the requested API resource</strong></h3> <h4 id="request-example-2"><a href="#request-example-2" class="header-anchor">#</a> Request example</h4> <p><code>POST</code> - <code>/indexes/movies/search</code></p> <h4 id="headers-7"><a href="#headers-7" class="header-anchor">#</a> Headers</h4> <div class="language- extra-class"><pre class="language-text"><code>    &quot;Authorization: Bearer :apiKey&quot;
    &quot;Content-Type: application/json&quot;
</code></pre></div><h4 id="response-7"><a href="#response-7" class="header-anchor">#</a> Response</h4> <ul><li>🔴 Accessing this route with an <code>API Key</code> that don't have sufficient permissions to access it returns an <a href="/specifications/text/0061-error-format-and-definitions.html#invalid_api_key">invalid_api_key</a> error.</li></ul> <h2 id="_2-technical-aspects"><a href="#_2-technical-aspects" class="header-anchor">#</a> 2. Technical Aspects</h2> <h3 id="_2-1-api-key-generation"><a href="#_2-1-api-key-generation" class="header-anchor">#</a> 2.1 API Key generation</h3> <p>A prefix of 8 characters is randomly generated per key and is stored within the instance.</p> <p>The final key is then a SHA-2556 hash made of the prefix and the master-key concatenation.</p> <p><code>SHA-256(:randomizedPrefix, :master-key)</code> gives the final <code>key</code> field to use.</p> <h3 id="_2-2-synchronous-write-of-api-key-resources"><a href="#_2-2-synchronous-write-of-api-key-resources" class="header-anchor">#</a> 2.2 Synchronous write of <code>API Key</code> resources</h3> <p>Writing to <code>/keys</code> endpoints are synchronous in order to return errors directly to the user when he performs an operation on them.</p> <h3 id="_2-3-propagating-api-key-to-a-dump"><a href="#_2-3-propagating-api-key-to-a-dump" class="header-anchor">#</a> 2.3 Propagating <code>API Key</code> to a dump.</h3> <p>The generated API keys must also transit within a dump to facilitate the upgrade of a MeiliSearch instance.</p> <blockquote><p>🚨 As a reminder, dumps must be stored in secure areas not accessible to the public or unaccredited persons. In general, you should avoid moving them off the host machine or do so via a secure channel as a security measure.</p></blockquote> <p>If the dumps ever leak, the api keys cannot be spoofed from the dump inspection because it needs the master-key to have the full value of a valid API key. Only the randomized prefixes are propagated in the dumps.</p> <h3 id="_2-4-propagating-api-key-to-snapshots"><a href="#_2-4-propagating-api-key-to-snapshots" class="header-anchor">#</a> 2.4 Propagating <code>API Key</code> to snapshots.</h3> <p>The generated API keys must also transit within a snapshot to facilitate the recovery of a MeiliSearch instance.</p> <blockquote><p>🚨 As a reminder, snapshots must be stored in secure areas not accessible to the public or unaccredited persons. In general, you should avoid moving them off the host machine or do so via a secure channel as a security measure.</p></blockquote> <p>If the snapshot ever leak, the <code>API Keys</code> cannot be spoofed from the snapshot inspection because it needs the master-key to have the full value of a valid <code>API key</code>. Only the randomized prefixes are propagated in the snapshots.</p> <h3 id="_2-5-api-keys-storage-size-limit"><a href="#_2-5-api-keys-storage-size-limit" class="header-anchor">#</a> 2.5 API Keys storage size limit</h3> <p>The maximum size of the API key storage is <code>100GB</code>.</p> <h2 id="_3-future-possibilities"><a href="#_3-future-possibilities" class="header-anchor">#</a> 3. Future Possibilities</h2> <ul><li>Regenerate a specific <code>API Key</code>.</li> <li>Add a generated id field to paginate the list of API Key.</li> <li>Have a filer/dedicated route to fetch expired key if MeiliSearch do not display them by default on <code>/keys</code> in the future.</li> <li>Have an &quot;archive&quot; state where manually deleted API Keys can be restored for a certain amount of time.</li> <li>Add rate-limiting per API Key.</li> <li>A restriction on the maximum offset/limit.</li> <li>Add search parameters restrictions for an API Key.</li> <li>Add rfc2822 format expression for <code>expiredAt</code> field. e.g. <code>Wed, 18 Feb 2022 23:16:09 GMT</code></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/specifications/text/0077-words-position-limit.html" class="prev">
        Words position limit
      </a></span> <span class="next"><a href="/specifications/text/0089-tenant-tokens.html">
        Tenant tokens
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.715a2d53.js" defer></script><script src="/assets/js/3.7860be15.js" defer></script><script src="/assets/js/32.e18b0f3d.js" defer></script>
  </body>
</html>
