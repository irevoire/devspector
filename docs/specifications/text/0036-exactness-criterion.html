<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Welcome to the Meilisearch dev specifications!</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.b26ff90a.css" as="style"><link rel="preload" href="/assets/js/app.f612afe2.js" as="script"><link rel="preload" href="/assets/js/3.7860be15.js" as="script"><link rel="preload" href="/assets/js/20.bbf42276.js" as="script"><link rel="prefetch" href="/assets/js/10.867f19e5.js"><link rel="prefetch" href="/assets/js/11.729a6b35.js"><link rel="prefetch" href="/assets/js/12.3fc27b6c.js"><link rel="prefetch" href="/assets/js/13.569b541d.js"><link rel="prefetch" href="/assets/js/14.5eb4b1a7.js"><link rel="prefetch" href="/assets/js/15.ffba3d85.js"><link rel="prefetch" href="/assets/js/16.5bbcf611.js"><link rel="prefetch" href="/assets/js/17.052e3dd6.js"><link rel="prefetch" href="/assets/js/18.1930f072.js"><link rel="prefetch" href="/assets/js/19.1ce2f361.js"><link rel="prefetch" href="/assets/js/21.2d9b101a.js"><link rel="prefetch" href="/assets/js/22.1f07eccb.js"><link rel="prefetch" href="/assets/js/23.49f62338.js"><link rel="prefetch" href="/assets/js/24.bdd429da.js"><link rel="prefetch" href="/assets/js/25.d65be380.js"><link rel="prefetch" href="/assets/js/26.d95b24bd.js"><link rel="prefetch" href="/assets/js/27.657689b8.js"><link rel="prefetch" href="/assets/js/28.6d50322d.js"><link rel="prefetch" href="/assets/js/29.28370923.js"><link rel="prefetch" href="/assets/js/30.9828f922.js"><link rel="prefetch" href="/assets/js/31.58809cac.js"><link rel="prefetch" href="/assets/js/32.733e95db.js"><link rel="prefetch" href="/assets/js/33.fbc8f9dc.js"><link rel="prefetch" href="/assets/js/34.bda1b03c.js"><link rel="prefetch" href="/assets/js/35.543c03a1.js"><link rel="prefetch" href="/assets/js/36.e60a6e3a.js"><link rel="prefetch" href="/assets/js/37.2e37d485.js"><link rel="prefetch" href="/assets/js/38.d9bfbb6f.js"><link rel="prefetch" href="/assets/js/39.c6446eba.js"><link rel="prefetch" href="/assets/js/4.3d6ce9d6.js"><link rel="prefetch" href="/assets/js/40.ac463bc0.js"><link rel="prefetch" href="/assets/js/41.9efc1325.js"><link rel="prefetch" href="/assets/js/42.578ced59.js"><link rel="prefetch" href="/assets/js/43.d2b6d075.js"><link rel="prefetch" href="/assets/js/44.a2214c33.js"><link rel="prefetch" href="/assets/js/45.2c7442dc.js"><link rel="prefetch" href="/assets/js/46.c82eebd0.js"><link rel="prefetch" href="/assets/js/47.42c0150d.js"><link rel="prefetch" href="/assets/js/48.02b2c80a.js"><link rel="prefetch" href="/assets/js/49.c3c4d010.js"><link rel="prefetch" href="/assets/js/5.06848b4d.js"><link rel="prefetch" href="/assets/js/50.20f74a2a.js"><link rel="prefetch" href="/assets/js/51.876e1cfd.js"><link rel="prefetch" href="/assets/js/6.87f02c74.js"><link rel="prefetch" href="/assets/js/7.fadbe260.js"><link rel="prefetch" href="/assets/js/8.d45b99a8.js"><link rel="prefetch" href="/assets/js/9.0c014273.js"><link rel="prefetch" href="/assets/js/vendors~docs-searchbar.9a2822a3.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b26ff90a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Welcome to the Meilisearch dev specifications!</span></a> <div class="links"><form id="search-form" role="search" class="meilisearch-search-wrapper search-box"><input id="meilisearch-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/specifications/text/specifications/text/0000-specification-template.html" class="nav-link">
  Specification
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/specifications/text/specifications/text/0000-specification-template.html" class="nav-link">
  Specification
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/specifications/text/0000-specification-template.html" class="sidebar-link">Specification template</a></li><li><a href="/specifications/text/0001-frontend-disable-prod.html" class="sidebar-link">Frontend disable prod</a></li><li><a href="/specifications/text/0001-script-based-tokenizer.html" class="sidebar-link">Script based tokenizer</a></li><li><a href="/specifications/text/0028-indexing-csv.html" class="sidebar-link">Indexing csv</a></li><li><a href="/specifications/text/0029-indexing-ndjson.html" class="sidebar-link">Indexing ndjson</a></li><li><a href="/specifications/text/0030-asc-desc-criterion.html" class="sidebar-link">Asc desc criterion</a></li><li><a href="/specifications/text/0032-distinct-attribute.html" class="sidebar-link">Distinct attribute</a></li><li><a href="/specifications/text/0033-logging.html" class="sidebar-link">Logging</a></li><li><a href="/specifications/text/0034-telemetry-policies.html" class="sidebar-link">Telemetry policies</a></li><li><a href="/specifications/text/0036-exactness-criterion.html" aria-current="page" class="active sidebar-link">Exactness criterion</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/specifications/text/0036-exactness-criterion.html#_1-functional-specification" class="sidebar-link">1. Functional Specification</a></li><li class="sidebar-sub-header"><a href="/specifications/text/0036-exactness-criterion.html#_2-technical-aspects" class="sidebar-link">2. Technical Aspects</a></li><li class="sidebar-sub-header"><a href="/specifications/text/0036-exactness-criterion.html#_3-future-possibilities" class="sidebar-link">3. Future Possibilities</a></li></ul></li><li><a href="/specifications/text/0038-rename-attributes-for-faceting.html" class="sidebar-link">Rename attributes for faceting</a></li><li><a href="/specifications/text/0043-phrase-query.html" class="sidebar-link">Phrase query</a></li><li><a href="/specifications/text/0047-reset-stop-words-synonyms-settings-with-null.html" class="sidebar-link">Reset stop words synonyms settings with null</a></li><li><a href="/specifications/text/0048-rename-max-mdb-size-var.html" class="sidebar-link">Rename max mdb size var</a></li><li><a href="/specifications/text/0055-sort.html" class="sidebar-link">Sort</a></li><li><a href="/specifications/text/0059-geo-search.html" class="sidebar-link">Geo search</a></li><li><a href="/specifications/text/0060-tasks-api.html" class="sidebar-link">Tasks api</a></li><li><a href="/specifications/text/0061-error-format-and-definitions.html" class="sidebar-link">Error format and definitions</a></li><li><a href="/specifications/text/0077-words-position-limit.html" class="sidebar-link">Words position limit</a></li><li><a href="/specifications/text/0085-api-keys.html" class="sidebar-link">Api keys</a></li><li><a href="/specifications/text/0089-tenant-tokens.html" class="sidebar-link">Tenant tokens</a></li><li><a href="/specifications/text/0096-auto-batching.html" class="sidebar-link">Auto batching</a></li><li><a href="/specifications/text/0105-dumps-api.html" class="sidebar-link">Dumps api</a></li><li><a href="/specifications/text/0117-typo-tolerance-setting-api.html" class="sidebar-link">Typo tolerance setting api</a></li><li><a href="/specifications/text/0118-search-api.html" class="sidebar-link">Search api</a></li><li><a href="/specifications/text/0119-instance-options.html" class="sidebar-link">Instance options</a></li><li><a href="/specifications/text/0121-data-types.html" class="sidebar-link">Data types</a></li><li><a href="/specifications/text/0123-displayed-attributes-setting-api.html" class="sidebar-link">Displayed attributes setting api</a></li><li><a href="/specifications/text/0123-distinct-attribute-setting-api.html" class="sidebar-link">Distinct attribute setting api</a></li><li><a href="/specifications/text/0123-filterable-attributes-setting-api.html" class="sidebar-link">Filterable attributes setting api</a></li><li><a href="/specifications/text/0123-ranking-rules-setting-api.html" class="sidebar-link">Ranking rules setting api</a></li><li><a href="/specifications/text/0123-searchable-attributes-setting-api.html" class="sidebar-link">Searchable attributes setting api</a></li><li><a href="/specifications/text/0123-settings-api.html" class="sidebar-link">Settings api</a></li><li><a href="/specifications/text/0123-sortable-attributes-setting-api.html" class="sidebar-link">Sortable attributes setting api</a></li><li><a href="/specifications/text/0123-stop-words-setting-api.html" class="sidebar-link">Stop words setting api</a></li><li><a href="/specifications/text/0123-synonyms-setting-api.html" class="sidebar-link">Synonyms setting api</a></li><li><a href="/specifications/text/0124-documents-api.html" class="sidebar-link">Documents api</a></li><li><a href="/specifications/text/0132-indexes-api.html" class="sidebar-link">Indexes api</a></li><li><a href="/specifications/text/0134-stats-api.html" class="sidebar-link">Stats api</a></li><li><a href="/specifications/text/157-faceting-setting-api.html" class="sidebar-link">Aceting setting api</a></li><li><a href="/specifications/text/157-pagination-setting-api.html" class="sidebar-link">Agination setting api</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><ul><li>Title: Exactness Criterion</li> <li>Start Date: 2021-04-22</li> <li>Specification PR: <a href="https://github.com/meilisearch/specifications/pull/36" target="_blank" rel="noopener noreferrer">#36<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>MeiliSearch Tracking-Issues: <a href="https://github.com/meilisearch/milli/issues/165" target="_blank" rel="noopener noreferrer">milli/#165<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h1 id="exactness-criterion"><a href="#exactness-criterion" class="header-anchor">#</a> Exactness Criterion</h1> <h2 id="_1-functional-specification"><a href="#_1-functional-specification" class="header-anchor">#</a> 1. Functional Specification</h2> <h3 id="i-summary"><a href="#i-summary" class="header-anchor">#</a> I. Summary</h3> <p>Exactness Criterion is used within ranking rules to sort results by the similarity of the matched words with the query words. Documents that contain exactly the same terms as the ones queried first are placed first.</p> <blockquote><p>Ranking rules are built-in rules that ensure relevancy in search results. Ranking rules are applied in a default order which can be changed in the settings. You can add or remove rules and change their order.</p></blockquote> <h3 id="ii-motivation"><a href="#ii-motivation" class="header-anchor">#</a> II. Motivation</h3> <p>While we continue to advance the new Milli engine towards a version offering the same features as Meilisearch.</p> <p>This specification aims to change the behavior of the <code>exactness</code> criterion to enhance the relevanvy of search results.</p> <h3 id="iii-additional-materials"><a href="#iii-additional-materials" class="header-anchor">#</a> III. Additional Materials</h3> <h4 id="typesense"><a href="#typesense" class="header-anchor">#</a> TypeSense</h4> <p>Typesense calculates a <code>_text_match</code> score for ranking the documents about text relevance.</p> <p><code>_text_match</code> score is computed from different criterias like frequency, edit distance, proximity and, ordering of <code>query_by</code> fields. <a href="https://typesense.org/docs/0.19.0/guide/ranking-and-relevance.html#text-match-score" target="_blank" rel="noopener noreferrer">See more details here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>If documents have the exact same <code>_text_match</code> score, TypeSense accepts two more numerical fields in the <code>sort_by</code> parameter to break the tie.</p> <p>E.g. <code>sort_by=_text_match:desc,price:desc,rating:desc</code></p> <p>It is possible to put a numerical field before the <code>_text_match</code> score.</p> <p>E.g. <code>sort_by=price:desc,_text_match:desc</code></p> <p><code>sort_by</code> parameter is set at query time.</p> <h4 id="algolia"><a href="#algolia" class="header-anchor">#</a> Algolia</h4> <p>Algolia explains the Exact criterion like:</p> <blockquote><p>Records with words that match query terms exactly are ranked higher. The more matching words in a record’s attribute, the higher a record is ranked. By default, an exact match occurs when a full word in a query is matched without typos to a word in an attribute. An inexact match is one that has typos or only matches on a prefix.</p></blockquote> <blockquote><p>Additionally, synonym matching and plural/singular matching are considered exact. Thus, a word is considered an exact match if its synonym matches a query exactly.</p></blockquote> <p>Adding some exceptions by default:</p> <p>[...] single-word matches on multi-word attributes aren’t considered exact matches by default [...]
[...] Multiword synonyms are not counted as exact matches by default [...]</p> <p>It is possible to specify that multi-words synonyms are considered an exact match using <code>alternativesAsExact</code> setting. Algolia also permit to disable some attributes to be used for exact criterion with <code>disableExactOnAttributes</code>setting.</p> <h3 id="iv-explanation"><a href="#iv-explanation" class="header-anchor">#</a> IV. Explanation</h3> <h4 id="current-meilisearch-behavior-0-20"><a href="#current-meilisearch-behavior-0-20" class="header-anchor">#</a> Current MeiliSearch Behavior (0.20)</h4> <p>For each word of the query we match documents:</p> <ul><li>without typo</li> <li>without prefix</li> <li>without ngrams</li> <li>without multi-words synonyms</li> <li>without word split</li></ul> <blockquote><p>If the query contains only one word, only attribute containing this one word value can match.</p></blockquote> <h5 id="pros-cons"><a href="#pros-cons" class="header-anchor">#</a> Pros &amp; Cons</h5> <p>This behavior of the Exact criterion gives a better rank to documents that match the words of the original query, ranking ngrams, complex synonyms, and word split after.</p> <p>In the specific case of a query containing only 1 word, only 1-word attributes matching will boost documents that have an attribute that exactly contains the query word.</p> <p>This is useful when an ID is searched but in others cases it could impact the relevancy of search results.</p> <p>Moreover, when users search with a multi-words query, attributes that exactly contains the query are not boosted.</p> <p>Because MeiliSearch is a search as you type engine, attributes that exactly begin by the original query should also be boosted.</p> <h4 id="milli-behavior-0-21"><a href="#milli-behavior-0-21" class="header-anchor">#</a> Milli Behavior (0.21)</h4> <p>We will divide Exactness into three layers of ranking.</p> <h5 id="layer-1-try-to-match-exactly-the-query-in-an-attribute"><a href="#layer-1-try-to-match-exactly-the-query-in-an-attribute" class="header-anchor">#</a> Layer 1: Try to match exactly the query in an attribute</h5> <p>Any document that has an attribute that contains exactly the query:</p> <ul><li>without typo</li> <li>without prefix</li> <li>without ngrams</li> <li>without multi-words synonyms</li> <li>without word split</li> <li>with words in the right order</li></ul> <p>has a rank of <code>0</code> (perfect match)</p> <h5 id="layer-2-try-to-match-exactly-the-query-at-the-start-of-an-attribute"><a href="#layer-2-try-to-match-exactly-the-query-at-the-start-of-an-attribute" class="header-anchor">#</a> Layer 2: Try to match exactly the query at the start of an attribute</h5> <p>Any document that has an attribute that contains the query at the n firsts positions:</p> <ul><li>without typo</li> <li>without prefix</li> <li>without ngrams</li> <li>without multi-words synonyms</li> <li>without word split</li> <li>with words in the right order</li></ul> <p>has a rank of <code>1</code> (the user didn't finish to type the search but the final query could possibly be an exact match)</p> <h5 id="layer-3-try-to-match-exactly-the-word-of-the-query-anywhere-in-the-document"><a href="#layer-3-try-to-match-exactly-the-word-of-the-query-anywhere-in-the-document" class="header-anchor">#</a> Layer 3: Try to match exactly the word of the query anywhere in the document</h5> <p>Any other document has a rank of <code>2 + 1</code> for each word that is not an exact match.</p> <p>A word is considered as an exact match when it matches:</p> <ul><li>without typo</li> <li>without prefix</li> <li>without ngrams</li> <li>without multi-words synonyms</li> <li>without word split</li></ul> <blockquote><p>Given theses layered operations, the higher the rank of a document is, the less relevant it is.</p></blockquote> <h3 id="v-impact-on-documentation"><a href="#v-impact-on-documentation" class="header-anchor">#</a> V. Impact on Documentation</h3> <p>N/A</p> <h3 id="vi-impact-on-sdks"><a href="#vi-impact-on-sdks" class="header-anchor">#</a> VI. Impact on SDKs</h3> <p>N/A</p> <h2 id="_2-technical-aspects"><a href="#_2-technical-aspects" class="header-anchor">#</a> 2. Technical Aspects</h2> <p>N/A</p> <h2 id="_3-future-possibilities"><a href="#_3-future-possibilities" class="header-anchor">#</a> 3. Future Possibilities</h2> <ul><li>In the second layer, we can rank <code>Any document that has an attribute that contains exactly the query</code> with the last word considered as prefix.</li> <li>Give the user the possibility to deactivate some fields for the Exactness criterion.</li> <li>Rename the Exactness criterion.</li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/specifications/text/0034-telemetry-policies.html" class="prev">
        Telemetry policies
      </a></span> <span class="next"><a href="/specifications/text/0038-rename-attributes-for-faceting.html">
        Rename attributes for faceting
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.f612afe2.js" defer></script><script src="/assets/js/3.7860be15.js" defer></script><script src="/assets/js/20.bbf42276.js" defer></script>
  </body>
</html>
